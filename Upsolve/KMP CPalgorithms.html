<!DOCTYPE html>
<!-- saved from url=(0053)https://cp-algorithms.com/string/prefix-function.html -->
<html class=" ya-page_js_yes"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!--<base href="https://cp-algorithms.com">--><base href=".">
    <title>Prefix function. Knuth–Morris–Pratt algorithm  - Competitive Programming Algorithms</title>
    <script async="" src="./KMP CPalgorithms_files/analytics.js"></script><script type="text/javascript" async="" charset="utf-8" src="./KMP CPalgorithms_files/all.js"></script><script src="./KMP CPalgorithms_files/jq.js"></script>
    <script src="./KMP CPalgorithms_files/common.js"></script>
    <script type="text/x-mathjax-config;executed=true">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>
    <script type="text/javascript" src="./KMP CPalgorithms_files/MathJax.js">
    </script>
    <link rel="stylesheet" href="./KMP CPalgorithms_files/common.css">

    <!-- highlightjs for code highlighting -->
    <link rel="stylesheet" href="./KMP CPalgorithms_files/xcode.min.css">
    <script src="./KMP CPalgorithms_files/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <!-- end highlightjs -->
    <meta name="google-site-verification" content="qSnbeMPNVgZ3kIpGVsPIAPIvEdwYSg583kPdwgJtFO8">
    <meta name="yandex-verification" content="f327630b02a1e115">
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">#ya-site-form0,#ya-site-form0 .ya-site-form__form,#ya-site-form0 .ya-site-form__input,#ya-site-form0 .ya-site-form__input-text,#ya-site-form0 .ya-site-form__submit,#ya-site-form0 .ya-site-form__search-precise{font-size:12px!important;color:#000!important}#ya-site-form0 .ya-site-form__form-form{display:block}#ya-site-form0 .ya-site-form__form-form,#ya-site-form0 .ya-site-form__input,#ya-site-form0 .ya-site-form__search-precise,#ya-site-form0 .ya-site-form__search-precise__radio,#ya-site-form0 .ya-site-form__gap,#ya-site-form0 .ya-site-form__gap-i,#ya-site-form0 .ya-site-form__logo-img{margin:0;padding:0}#ya-site-form0{margin:0!important;padding:0!important}#ya-site-form0 .ya-site-form__logo-wrap{width:65px;vertical-align:top;border-collapse:collapse}#ya-site-form0 .ya-site-form__logo{display:block;width:52px;margin:0;padding:0 6px 0 0;text-decoration:none}#ya-site-form0 .ya-site-form__logo-img{width:52px;height:21px;border:0!important}#ya-site-form0 .ya-site-form__search-wrap{border-collapse:collapse}#ya-site-form0 .ya-site-form__search{font-size:12px!important;width:100%}#ya-site-form0 .ya-site-form__search-input,#ya-site-form0 .ya-site-form__search-precise,{border:0}#ya-site-form0 .ya-site-form__search-input{padding:6px}#ya-site-form0 .ya-site-form__search-input-layout,#ya-site-form0 .ya-site-form__search-input-layout-l,#ya-site-form0 .ya-site-form__search-input-layout-r{font-size:12px!important;padding:0;vertical-align:middle;border:0;border-collapse:collapse}#ya-site-form0 .ya-site-form__search-input-layout,#ya-site-form0 .ya-site-form__search-input-layout-l{width:100%}#ya-site-form0 .ya-site-form__search-precise{padding:0 18px 5px 6px;text-align:left;vertical-align:top}#ya-site-form0 .ya-site-form__search-precise-i{white-space:nowrap}#ya-site-form0 .ya-site-form__search-precise__radio{width:auto;margin:0 .3em 0 0;vertical-align:middle;background:none}#ya-site-form0 .ya-site-form__search-precise__label{margin:0 .4em 0 0;padding:0;vertical-align:middle}#ya-site-form0 .ya-site-form__input-text{width:100%;margin:0!important;cursor:text;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;background-color:#fff;border:1px solid #7f9db9;outline-style:none;-webkit-appearance:textfield}#ya-site-form0 .ya-site-form__input-text_type_hint{background-repeat:no-repeat;background-position:.2em 50%}#ya-site-form0 .ya-site-form__submit{display:block;width:auto;margin:0 0 0 5px}#ya-site-form0 .ya-site-form__arrow-wrap{overflow:hidden;width:30px;padding:0;vertical-align:middle}#ya-site-form0 .ya-site-form__arrow{position:relative}#ya-site-form0 .ya-site-form__arrow-a{position:absolute;top:50%;right:0;width:0;height:0;margin-top:-59px;border:solid transparent;border-width:59px 0 59px 30px;-moz-border-end-style:dotted}#ya-site-form0 .ya-site-form__wrap{width:100%;table-layout:fixed;border-collapse:collapse}#ya-site-form0 .ya-site-form__gap{border:0}#ya-site-form0 .ya-site-form__gap-i{width:9em}#ya-site-form0.ya-site-form_arrow_yes .ya-site-form__search-input{padding-right:0}#ya-site-form0.ya-site-form_logo_left .ya-site-form__logo{margin-top:4px;margin-left:5px}#ya-site-form0.ya-site-form_logo_top .ya-site-form__logo{display:block;margin:6px 0 0 6px}#ya-site-form0 .ya-site-form__submit_type_image{width:19px;height:15px;outline:none;cursor:pointer;border:0}#ya-site-form0 .ya-site-form__submit_type_image { background: url(https://site.yandex.net/v2.0/i/en/search.png) no-repeat }#ya-site-form0 .ya-site-form__input-text_type_hint { background-image:url(https://site.yandex.net/v2.0/i/en/yandex-hint-rb.png) }#ya-site-form0 .ya-site-form__form * { font-size: 12px !important }#ya-site-form0 .ya-site-form__form .ya-site-form__input-text { font-style: normal!important }#ya-site-form0 .ya-site-form__form .ya-site-form__input-text { font-weight: normal!important }#ya-site-form0 .ya-site-form__form .ya-site-form__input-text { color: #000000!important }#ya-site-form0 .ya-site-form__form .ya-site-form__input-text { border-color: #7f9db9!important }#ya-site-form0 .ya-site-form__form .ya-site-form__input-text:focus { border-color: #7f9db9!important }#ya-site-form0 .ya-site-form__form .ya-site-form__input-text { background-color: #ffffff!important }#ya-site-form0 .ya-site-form__search, #ya-site-form0 .ya-site-form__search td, #ya-site-form0 .yaform__precise-i { background-color: transparent !important }#ya-site-form0 .ya-site-form__search-precise__label { color:#000000 !important }#ya-site-form0 .ya-site-form__arrow-a { border-left-color: transparent }</style><style type="text/css">#ya-site-form0 .ya-site-suggest{position:relative;margin:0}#ya-site-form0 .ya-site-suggest-popup{position:absolute;width:100%}#ya-site-form0 .ya-site-suggest__opera-gap{position:absolute;height:25em;border:1px solid transparent}#ya-site-form0 .ya-site-suggest-list{position:absolute;z-index:9999;overflow:hidden;min-width:25em;width:100%;margin-top:-1px;border-collapse:separate;-webkit-box-shadow:0 1px 7px #9a9a9a;-moz-box-shadow:0 1px 7px #9a9a9a;box-shadow:0 1px 7px #9a9a9a;border:1px solid #dedede;border-color:rgba(154,154,154,0.5);border-top-color:rgba(154,154,154,0.4);border-bottom-color:rgba(154,154,154,0.6)}#ya-site-form0 .ya-site-suggest-list{box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}#ya-site-form0 .ya-site-suggest__iframe{position:absolute;z-index:-1;min-width:25em;width:100%;height:100%;background:#fff}#ya-site-form0 .ya-site-suggest-items{font-size:16px;min-width:25em;width:100%;margin:0;padding:0 1px 0 0;list-style:none}#ya-site-form0 .ya-site-suggest-items li{margin:0;padding:0;line-height:normal}#ya-site-form0 .ya-site-suggest-elem{display:block;padding:.25em .3em;cursor:pointer;background:url()}#ya-site-form0 a.ya-site-suggest-elem:link,#ya-site-form0 a.ya-site-suggest-elem:visited{text-decoration:none}html body #ya-site-form0 .ya-site-suggest-elem:link,html body #ya-site-form0 .ya-site-suggest-elem-link{color:#000!important}#ya-site-form0 .ya-site-suggest-elem:hover,html body #ya-site-form0 .ya-site-suggest-elem_state_hover{background:#fef6d7}#ya-site-form0 .ya-site-suggest-elem_nav:hover,#ya-site-form0 .ya-site-suggest-elem_translate:hover{text-decoration:none;color:#000!important}#ya-site-form0 .ya-site-suggest-elem_nav .ya-site-suggest__link{text-decoration:underline;color:#1a3dc1}#ya-site-form0 .ya-site-suggest-elem_translate .ya-site-suggest__link{text-decoration:underline;color:#000}#ya-site-form0 .ya-site-suggest-elem .ya-site-suggest__info{white-space:nowrap;color:#666}#ya-site-form0 .ya-site-suggest-elem_selected{background:#fdedaf}#ya-site-form0 .ya-site-suggest__fact{color:#555}#ya-site-form0 .ya-site-suggest__highlight{font-weight:bold}</style><link title="search e-maxx-eng" rel="search" type="application/opensearchdescription+xml" href="https://yandex.com/search/site/opensearch.xml?ShortName=search%20e-maxx-eng&amp;InputEncoding=utf-8&amp;Image=&amp;Url-results=https%3A%2F%2Fcp-algorithms.com%2Fsearch-results.html%3Fsearchid%3D2314495%26web%3D0%26text%3D%7BsearchTerms%7D&amp;Url-suggest=https%3A%2F%2Fsitesearch-suggest.yandex.ru%2Fv1%2Fsuggest%3F%26site%3D2314495%26lang%3Den%26part%3D%7BsearchTerms%7D&amp;Url-opensearchdescr=https%3A%2F%2Fyandex.com%2Fsearch%2Fsite%2Fopensearch.xml%3FShortName%3Dsearch%2520e-maxx-eng%26InputEncoding%3Dutf-8%26Image%3D%26Url-results%3Dhttps%253A%252F%252Fcp-algorithms.com%252Fsearch-results.html%253Fsearchid%253D2314495%2526web%253D0%2526text%253D%257BsearchTerms%257D%26Url-suggest%3Dhttps%253A%252F%252Fsitesearch-suggest.yandex.ru%252Fv1%252Fsuggest%253F%2526site%253D2314495%2526lang%253Den%2526part%253D%257BsearchTerms%257D"><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.1') format('opentype')}
</style></head>
<body data-v="2019-12-24:5888/2477 2019-12-23:6561/2857 2019-12-22:5869/2579 2019-12-21:5919/2495 2019-12-20:3381/1459 2019-12-19:0/0 2019-12-18:0/0" style=""><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
<div id="container">
    <div id="navbar">
        <span id="title">
            <a href="https://cp-algorithms.com/">CP-Algorithms</a>
        </span>
        <span id="menu">
            <a href="https://github.com/e-maxx-eng/e-maxx-eng/commits/master/src/string/prefix-function.md" title="Changes History">Page Authors</a>
        </span>
        <span id="search" style="display:inline-block;width:200px;float:right;margin-top:7px;margin-right:20px;">
            <div class="ya-site-form ya-site-form_bg_transparent ya-site-form_logo_hint ya-site-form_inited_yes" id="ya-site-form0"><div class="ya-site-form__form"><table class="ya-site-form__wrap" cellpadding="0" cellspacing="0"><tbody><tr><td class="ya-site-form__search-wrap"><table class="ya-site-form__search" cellpadding="0" cellspacing="0"><tbody><tr><td class="ya-site-form__search-input"><table class="ya-site-form__search-input-layout"><tbody><tr><td class="ya-site-form__search-input-layout-l"><div class="ya-site-form__input"><input name="text" type="search" value="" class="ya-site-form__input-text ya-site-form__input-text_type_hint" autocomplete="off"><div class="ya-site-suggest"><div class="ya-site-suggest-popup" style="display: none;"><i class="ya-site-suggest__opera-gap"></i><div class="ya-site-suggest-list"><div class="ya-site-suggest__iframe"></div><ul class="ya-site-suggest-items"></ul></div></div></div></div></td><td class="ya-site-form__search-input-layout-r"><input class="ya-site-form__submit" type="button" value="Search"></td></tr></tbody></table></td></tr><tr><td class="ya-site-form__gap"><div class="ya-site-form__gap-i"></div></td></tr></tbody></table></td></tr></tbody></table></div></div><style type="text/css">.ya-page_js_yes .ya-site-form_inited_no { display: none; }</style><script type="text/javascript">(function(w,d,c){var s=d.createElement('script'),h=d.getElementsByTagName('script')[0],e=d.documentElement;if((' '+e.className+' ').indexOf(' ya-page_js_yes ')===-1){e.className+=' ya-page_js_yes';}s.type='text/javascript';s.async=true;s.charset='utf-8';s.src=(d.location.protocol==='https:'?'https:':'http:')+'//site.yandex.net/v2.0/js/all.js';h.parentNode.insertBefore(s,h);(w[c]||(w[c]=[])).push(function(){Ya.Site.Form.init()})})(window,document,'yandex_site_callbacks');</script>
        </span>
    </div>
<h1>Prefix function. Knuth–Morris–Pratt algorithm</h1><div id="toc"><strong>Table of Contents</strong><br><div class="toc-H2"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-0">Prefix function definition</a><a></a></div><div class="toc-H2"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-1">Trivial Algorithm</a><a></a></div><div class="toc-H2"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-2">Efficient Algorithm</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-3">First optimization</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-4">Second optimization</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-5">Final algorithm</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-6">Implementation</a><a></a></div><div class="toc-H2"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-7">Applications</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-8">Search for a substring in a string. The Knuth-Morris-Pratt algorithm</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-9">Counting the number of occurrences of each prefix</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-10">The number of different substring in a string</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-11">Compressing a string</a><a></a></div><div class="toc-H3"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-12">Building an automaton according to the prefix function</a><a></a></div><div class="toc-H2"><a href="https://cp-algorithms.com/string/prefix-function.html#toc-tgt-13">Practice Problems</a><a></a></div></div>

<h2 id="toc-tgt-0">Prefix function definition</h2>

<p>You are given a string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">s</script> of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">n</script>.
The <strong>prefix function</strong> for this string is defined as an array <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">\pi</script> of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">n</script>, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" style="width: 1.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.4em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">\pi[i]</script> is the length of the longest proper prefix of the substring <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-19" style="width: 4.329em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.32em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.22em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-23" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-24" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">i</span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mn>0</mn><mo>…</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">s[0 \dots i]</script> which is also a suffix of this substring.
A proper prefix of a string is a prefix that is not equal to the string itself.
By definition, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-27" style="width: 4.57em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.512em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.46em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-28"><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-31" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-32" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-34" style="font-family: MathJax_Main; padding-left: 0.291em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-7">\pi[0] = 0</script>.</p>

<p>Mathematically the definition of the prefix function can be written as follows:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-35" style="width: 28.272em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.733em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1021.68em, 3.127em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-36"><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="munderover" id="MathJax-Span-42" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 2.358em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1001.83em, 4.137em, -999.998em); top: -3.988em; left: 0.243em;"><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1002.31em, 4.233em, -999.998em); top: -3.315em; left: 0em;"><span class="texatom" id="MathJax-Span-44"><span class="mrow" id="MathJax-Span-45"><span class="mi" id="MathJax-Span-46" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-47" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-48" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">…</span><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">{</span><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main; padding-left: 0.291em;">:</span><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">s</span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-56" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">k</span><span class="mo" id="MathJax-Span-59" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-60" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">s</span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main; padding-left: 0.243em;">(</span><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-70" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">i</span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><munder><mo movablelimits="true" form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>=</mo><mn>0</mn><mo>…</mo><mi>i</mi></mrow></munder><mo fence="false" stretchy="false">{</mo><mi>k</mi><mo>:</mo><mi>s</mi><mo stretchy="false">[</mo><mn>0</mn><mo>…</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mo stretchy="false">(</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>…</mo><mi>i</mi><mo stretchy="false">]</mo><mo fence="false" stretchy="false">}</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">\pi[i] = \max_ {k = 0 \dots i} \{k : s[0 \dots k-1] = s[i-(k-1) \dots i] \}</script></p>

<p>For example, prefix function of string "abcabcd" is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-76" style="width: 8.656em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.637em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1006.54em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-77"><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-79" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-80" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-81" style="font-family: MathJax_Main; padding-left: 0.147em;">0</span><span class="mo" id="MathJax-Span-82" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-83" style="font-family: MathJax_Main; padding-left: 0.147em;">0</span><span class="mo" id="MathJax-Span-84" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-85" style="font-family: MathJax_Main; padding-left: 0.147em;">1</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-87" style="font-family: MathJax_Main; padding-left: 0.147em;">2</span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-89" style="font-family: MathJax_Main; padding-left: 0.147em;">3</span><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-91" style="font-family: MathJax_Main; padding-left: 0.147em;">0</span><span class="mo" id="MathJax-Span-92" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>0</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">[0, 0, 0, 1, 2, 3, 0]</script>, and prefix function of string "aabaaab" is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-93" style="width: 8.656em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.637em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1006.54em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-94"><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-96" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-98" style="font-family: MathJax_Main; padding-left: 0.147em;">1</span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-100" style="font-family: MathJax_Main; padding-left: 0.147em;">0</span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-102" style="font-family: MathJax_Main; padding-left: 0.147em;">1</span><span class="mo" id="MathJax-Span-103" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-104" style="font-family: MathJax_Main; padding-left: 0.147em;">2</span><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-106" style="font-family: MathJax_Main; padding-left: 0.147em;">2</span><span class="mo" id="MathJax-Span-107" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-108" style="font-family: MathJax_Main; padding-left: 0.147em;">3</span><span class="mo" id="MathJax-Span-109" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-10">[0, 1, 0, 1, 2, 2, 3]</script>.</p>

<h2 id="toc-tgt-1">Trivial Algorithm</h2>

<p>An algorithm which follows the definition of prefix function exactly is the following:</p>

<pre><code class="cpp hljs"><span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span> prefix_function(<span class="hljs-built_in">string</span> s) {
    <span class="hljs-keyword">int</span> n = (<span class="hljs-keyword">int</span>)s.length();
    <span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span> pi(n);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> k = <span class="hljs-number">0</span>; k &lt;= i; k++)
            <span class="hljs-keyword">if</span> (s.substr(<span class="hljs-number">0</span>, k) == s.substr(i-k+<span class="hljs-number">1</span>, k))
                pi[i] = k;
    <span class="hljs-keyword">return</span> pi;
}
</code></pre>

<p>It is easy to see that its complexity is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-110" style="width: 3.32em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.55em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.252em, 1002.45em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-111"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-114"><span style="display: inline-block; position: relative; width: 1.012em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.58em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.579em;"><span class="mn" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">O(n^3)</script>, which has room for improvement.</p>

<h2 id="toc-tgt-2">Efficient Algorithm</h2>

<p>This algorithm was proposed by Knuth and Pratt and independently from them by Morris in 1977. 
It was used as the main function of a substring search algorithm.</p>

<h3 id="toc-tgt-3">First optimization</h3>

<p>The first important observation is, that the values of the prefix function can only increase by at most one.</p>

<p>Indeed, otherwise, if <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x003E;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-118" style="width: 10.195em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.839em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1007.74em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-119"><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-124" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main; padding-left: 0.291em;">&gt;</span><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-132" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>&gt;</mo><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-12">\pi[i + 1] \gt \pi[i] + 1</script>, then we can take this suffix ending in position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-133" style="width: 2.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.118em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.02em, 2.454em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-134"><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-136" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-137" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-13">i + 1</script> with the length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-138" style="width: 4.185em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.224em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.13em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-139"><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-141" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-142" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-144" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-14">\pi[i + 1]</script> and remove the last character from it.
We end up with a suffix ending in position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-146" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-147"><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">i</script> with the length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-149" style="width: 6.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.002em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1004.91em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-150"><span class="mi" id="MathJax-Span-151" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-154" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-155" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-158" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-16">\pi[i + 1] - 1</script>, which is better than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-159" style="width: 1.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.4em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">\pi[i]</script>, i.e. we get a contradiction.</p>

<p>The following illustration shows this contradiction.
The longest proper suffix at position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-165" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-166"><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">i</script> that also is a prefix is of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-168" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.43em, 2.358em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-169"><span class="mn" id="MathJax-Span-170" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-19">2</script>, and at position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-171" style="width: 2.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.118em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.02em, 2.454em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-172"><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-175" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-20">i+1</script> it is of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-176" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.43em, 2.358em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-177"><span class="mn" id="MathJax-Span-178" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-21">4</script>.
Therefore the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-179" style="width: 5.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.425em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.637em, 1004.42em, 2.502em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-180"><span class="msubsup" id="MathJax-Span-181"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-183" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-184" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-185"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-186" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-187" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-188" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-189"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-190" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-191" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-192" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-193"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-195" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>0</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>1</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>2</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-22">s_0 ~ s_1 ~ s_2 ~ s_3</script> is equal to the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-196" style="width: 8.56em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.589em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.637em, 1006.59em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-197"><span class="msubsup" id="MathJax-Span-198"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-200"><span class="mrow" id="MathJax-Span-201"><span class="mi" id="MathJax-Span-202" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-204" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-205" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-206"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-207" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-208"><span class="mrow" id="MathJax-Span-209"><span class="mi" id="MathJax-Span-210" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-211" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-212" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-213" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-214"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mi" id="MathJax-Span-216" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-217" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-218"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-220"><span class="mrow" id="MathJax-Span-221"><span class="mi" id="MathJax-Span-222" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-223" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-224" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>2</mn></mrow></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mi>i</mi></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-23">s_{i-2} ~ s_{i-1} ~ s_i ~ s_{i+1}</script>, which means that also the strings <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-225" style="width: 4.281em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.272em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.637em, 1003.27em, 2.502em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-226"><span class="msubsup" id="MathJax-Span-227"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-229" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-230" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-231"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-233" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-234" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-235"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-237" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mn>0</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>1</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">s_0 ~ s_1 ~ s_2</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-238" style="width: 6.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.666em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.637em, 1004.67em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-239"><span class="msubsup" id="MathJax-Span-240"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-241" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-242"><span class="mrow" id="MathJax-Span-243"><span class="mi" id="MathJax-Span-244" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-245" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-246" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-247" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-248"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-250"><span class="mrow" id="MathJax-Span-251"><span class="mi" id="MathJax-Span-252" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-253" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-254" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-255" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-256"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mi" id="MathJax-Span-258" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>2</mn></mrow></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">s_{i-2} ~ s_{i-1} ~ s_i</script> are equal, therefore <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-259" style="width: 1.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.4em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-260"><span class="mi" id="MathJax-Span-261" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-262" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-264" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">\pi[i]</script> has to be <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-265" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.43em, 2.358em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-266"><span class="mn" id="MathJax-Span-267" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-27">3</script>.
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-268" style="width: 16.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.031em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.05em, 1013.03em, 4.281em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-269"><span class="munderover" id="MathJax-Span-270"><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; clip: rect(1.829em, 1004.38em, 5.05em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="munderover" id="MathJax-Span-273"><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; clip: rect(1.829em, 1004.38em, 4.281em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-274"><span class="munderover" id="MathJax-Span-275"><span style="display: inline-block; position: relative; width: 2.07em; height: 0px;"><span style="position: absolute; clip: rect(2.743em, 1002.07em, 4.281em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-276"><span class="mrow" id="MathJax-Span-277"><span class="munderover" id="MathJax-Span-278"><span style="display: inline-block; position: relative; width: 2.07em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1002.07em, 4.281em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-279"><span class="msubsup" id="MathJax-Span-280"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-282" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-283" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-284"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-285" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-286" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1002.07em, 2.502em, -999.998em); top: -2.93em; left: 0em;"><span class="mo" id="MathJax-Span-287" style=""><span style="display: inline-block; position: relative; width: 2.07em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 1.589em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.579em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.339em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.349em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.224em, 1001.92em, 4.329em, -999.998em); top: -5.382em; left: 0.05em;"><span class="texatom" id="MathJax-Span-288"><span class="mrow" id="MathJax-Span-289"><span class="mi" id="MathJax-Span-290" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-291" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-292" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-293" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-294" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-295" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-296" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-297"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-298" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-299" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-300" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-301"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-302" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-303" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1004.38em, 2.502em, -999.998em); top: -1.488em; left: 0em;"><span class="mo" id="MathJax-Span-304" style=""><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 3.897em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 1.733em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.724em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.06em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.397em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.55em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.887em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.224em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.56em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.32em, 1002.84em, 4.425em, -999.998em); top: -2.401em; left: 0.772em;"><span class="texatom" id="MathJax-Span-305"><span class="mrow" id="MathJax-Span-306"><span class="mi" id="MathJax-Span-307" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-308" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-309" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-310" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-311" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-312" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-313" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-314" style="font-size: 70.7%; font-family: MathJax_Main;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-315" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mtext" id="MathJax-Span-317" style="font-family: MathJax_Main; padding-left: 0.147em;">&nbsp;</span><span class="munderover" id="MathJax-Span-318"><span style="display: inline-block; position: relative; width: 6.685em; height: 0px;"><span style="position: absolute; clip: rect(1.829em, 1006.68em, 5.05em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-319"><span class="mrow" id="MathJax-Span-320"><span class="munderover" id="MathJax-Span-321"><span style="display: inline-block; position: relative; width: 6.685em; height: 0px;"><span style="position: absolute; clip: rect(1.829em, 1006.64em, 4.329em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-322"><span class="msubsup" id="MathJax-Span-323"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-324" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-325"><span class="mrow" id="MathJax-Span-326"><span class="mi" id="MathJax-Span-327" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-328" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-329" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-330" style="font-family: MathJax_Main;">&nbsp;</span><span class="munderover" id="MathJax-Span-331"><span style="display: inline-block; position: relative; width: 2.743em; height: 0px;"><span style="position: absolute; clip: rect(2.743em, 1002.74em, 4.329em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-332"><span class="mrow" id="MathJax-Span-333"><span class="munderover" id="MathJax-Span-334"><span style="display: inline-block; position: relative; width: 2.743em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1002.74em, 4.329em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-335"><span class="msubsup" id="MathJax-Span-336"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-338"><span class="mrow" id="MathJax-Span-339"><span class="mi" id="MathJax-Span-340" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-341" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-342" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-343" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-344"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-345" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-346"><span class="mrow" id="MathJax-Span-347"><span class="mi" id="MathJax-Span-348" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1002.74em, 2.502em, -999.998em); top: -2.93em; left: 0em;"><span class="mo" id="MathJax-Span-349" style=""><span style="display: inline-block; position: relative; width: 2.743em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 2.262em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.916em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.339em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.627em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.685em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.974em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.224em, 1001.92em, 4.329em, -999.998em); top: -5.382em; left: 0.387em;"><span class="texatom" id="MathJax-Span-350"><span class="mrow" id="MathJax-Span-351"><span class="mi" id="MathJax-Span-352" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-353" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-354" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-355" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-356" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-357" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-358" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-359"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-361"><span class="mrow" id="MathJax-Span-362"><span class="mi" id="MathJax-Span-363" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-364" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-365" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1006.68em, 2.502em, -999.998em); top: -1.44em; left: 0em;"><span class="mo" id="MathJax-Span-366" style=""><span style="display: inline-block; position: relative; width: 6.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 6.204em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 2.887em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.772em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.108em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.445em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.829em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.166em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.55em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.704em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.089em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.425em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.762em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.147em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.483em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.82em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.32em, 1002.84em, 4.425em, -999.998em); top: -2.353em; left: 1.925em;"><span class="texatom" id="MathJax-Span-367"><span class="mrow" id="MathJax-Span-368"><span class="mi" id="MathJax-Span-369" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-370" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-371" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-372" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-373" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-374" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-375" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-376" style="font-size: 70.7%; font-family: MathJax_Main;">4</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.559em; border-left: 0px solid; width: 0px; height: 5.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><msub><mi>s</mi><mn>0</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>1</mn></msub></mrow><mo>⏞</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mn>2</mn></mrow></mover><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>2</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>3</mn></msub></mrow><mo>⏟</mo></munder></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mn>4</mn></mrow></munder><mtext>&nbsp;</mtext><mo>…</mo><mtext>&nbsp;</mtext><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>2</mn></mrow></msub><mtext>&nbsp;</mtext><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow><mo>⏞</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mn>2</mn></mrow></mover><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>⏟</mo></munder></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mn>4</mn></mrow></munder></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-28">\underbrace{\overbrace{s_0 ~ s_1}^{\pi[i] = 2} ~ s_2 ~ s_3}_{\pi[i+1] = 4} ~ \dots ~ \underbrace{s_{i-2} ~ \overbrace{s_{i-1} ~ s_{i}}^{\pi[i] = 2} ~ s_{i+1}}_{\pi[i+1] = 4}</script></p>

<p>Thus when moving to the next position, the value of the prefix function can either increase by one, stay the same, or decrease by some amount.
This fact already allows us to reduce the complexity of the algorithm to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-377" style="width: 3.32em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.55em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.252em, 1002.45em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-378"><span class="mi" id="MathJax-Span-379" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-380" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-381"><span style="display: inline-block; position: relative; width: 1.012em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.58em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-382" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.579em;"><span class="mn" id="MathJax-Span-383" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-384" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-29">O(n^2)</script>, because in one step the prefix function can grow at most by one.
In total the function can grow at most <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-385" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-386"><span class="mi" id="MathJax-Span-387" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">n</script> steps, and therefore also only can decrease a total of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-388" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">n</script> steps.
This means we only have to perform <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-391" style="width: 2.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.166em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1002.07em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-392"><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-394" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-396" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-32">O(n)</script> string comparisons, and reach the complexity <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-397" style="width: 3.32em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.55em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.252em, 1002.45em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-398"><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-400" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-401"><span style="display: inline-block; position: relative; width: 1.012em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.58em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-402" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.579em;"><span class="mn" id="MathJax-Span-403" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-404" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-33">O(n^2)</script>.</p>

<h3 id="toc-tgt-4">Second optimization</h3>

<p>Let's go further, we want to get rid of the string comparisons.
To accomplish this, we have to use all the information computed in the previous steps.</p>

<p>So let us compute the value of the prefix function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-405" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-406"><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">\pi</script> for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-408" style="width: 2.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.118em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.02em, 2.454em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-409"><span class="mi" id="MathJax-Span-410" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-411" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-412" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-35">i + 1</script>.
If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-413" style="width: 9.137em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.022em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1006.92em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-414"><span class="mi" id="MathJax-Span-415" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-416" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-418" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-419" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-420" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-421" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">s</span><span class="mo" id="MathJax-Span-423" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-425" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-428" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>s</mi><mo stretchy="false">[</mo><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-36">s[i+1] = s[\pi[i]]</script>, then we can say with certainty that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-429" style="width: 10.195em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.839em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1007.74em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-430"><span class="mi" id="MathJax-Span-431" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-432" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-433" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-434" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-435" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-437" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-438" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-439" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-440" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-441" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-442" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-443" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-37">\pi[i+1] = \pi[i] + 1</script>, since we already know that the suffix at position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-444" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-445"><span class="mi" id="MathJax-Span-446" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">i</script> of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-447" style="width: 1.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.4em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-448"><span class="mi" id="MathJax-Span-449" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-450" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-451" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-452" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-39">\pi[i]</script> is equal to the prefix of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-453" style="width: 1.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.4em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-454"><span class="mi" id="MathJax-Span-455" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-456" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-457" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-458" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-40">\pi[i]</script>.
This is illustrated again with an example.
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-459" style="width: 20.099em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.05em, 1015.43em, 4.281em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-460"><span class="munderover" id="MathJax-Span-461"><span style="display: inline-block; position: relative; width: 5.868em; height: 0px;"><span style="position: absolute; clip: rect(1.829em, 1005.87em, 5.05em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-462"><span class="mrow" id="MathJax-Span-463"><span class="munderover" id="MathJax-Span-464"><span style="display: inline-block; position: relative; width: 5.868em; height: 0px;"><span style="position: absolute; clip: rect(1.829em, 1005.87em, 4.281em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-465"><span class="munderover" id="MathJax-Span-466"><span style="display: inline-block; position: relative; width: 3.224em; height: 0px;"><span style="position: absolute; clip: rect(2.743em, 1003.22em, 4.281em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-467"><span class="mrow" id="MathJax-Span-468"><span class="munderover" id="MathJax-Span-469"><span style="display: inline-block; position: relative; width: 3.224em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1003.17em, 4.281em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-470"><span class="msubsup" id="MathJax-Span-471"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-472" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-473" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-474" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-475"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-477" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-478" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-479"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-480" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-481" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1003.22em, 2.502em, -999.998em); top: -2.93em; left: 0em;"><span class="mo" id="MathJax-Span-482" style=""><span style="display: inline-block; position: relative; width: 3.224em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 2.743em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 1.156em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.435em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.772em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.022em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.358em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.224em, 1000.96em, 4.329em, -999.998em); top: -5.382em; left: 1.108em;"><span class="texatom" id="MathJax-Span-483"><span class="mrow" id="MathJax-Span-484"><span class="mi" id="MathJax-Span-485" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-486" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-487" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-488" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-489" style="font-family: MathJax_Main;">&nbsp;</span><span class="munderover" id="MathJax-Span-490"><span style="display: inline-block; position: relative; width: 2.406em; height: 0px;"><span style="position: absolute; clip: rect(2.743em, 1001.64em, 4.281em, -999.998em); top: -3.988em; left: 0.387em;"><span class="texatom" id="MathJax-Span-491"><span class="mrow" id="MathJax-Span-492"><span class="munderover" id="MathJax-Span-493"><span style="display: inline-block; position: relative; width: 1.637em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.92em, 4.281em, -999.998em); top: -3.988em; left: 0.387em;"><span class="msubsup" id="MathJax-Span-494"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-495" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-496" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1001.64em, 2.502em, -999.998em); top: -2.93em; left: 0em;"><span class="mo" id="MathJax-Span-497" style=""><span style="display: inline-block; position: relative; width: 1.637em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 1.156em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.416em, 1002.41em, 4.281em, -999.998em); top: -5.334em; left: 0em;"><span class="texatom" id="MathJax-Span-498"><span class="mrow" id="MathJax-Span-499"><span class="msubsup" id="MathJax-Span-500"><span style="display: inline-block; position: relative; width: 0.627em; height: 0px;"><span style="position: absolute; clip: rect(3.512em, 1000.29em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-501" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.892em; left: 0.339em;"><span class="mn" id="MathJax-Span-502" style="font-size: 50%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-503" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="msubsup" id="MathJax-Span-504"><span style="display: inline-block; position: relative; width: 1.204em; height: 0px;"><span style="position: absolute; clip: rect(3.512em, 1000.29em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-505" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.892em; left: 0.339em;"><span class="texatom" id="MathJax-Span-506"><span class="mrow" id="MathJax-Span-507"><span class="mi" id="MathJax-Span-508" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-509" style="font-size: 50%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-510" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1005.87em, 2.502em, -999.998em); top: -1.488em; left: 0em;"><span class="mo" id="MathJax-Span-511" style=""><span style="display: inline-block; position: relative; width: 5.868em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 5.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 2.502em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.724em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.108em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.445em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.781em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.118em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.32em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.656em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.993em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.377em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.714em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.05em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.32em, 1004.38em, 4.425em, -999.998em); top: -2.401em; left: 0.724em;"><span class="texatom" id="MathJax-Span-512"><span class="mrow" id="MathJax-Span-513"><span class="mi" id="MathJax-Span-514" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-515" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-516" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-517" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-518" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-519" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-520" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-521" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-522" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-523" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-524" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-525" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-526" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-527" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-528" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mtext" id="MathJax-Span-529" style="font-family: MathJax_Main; padding-left: 0.147em;">&nbsp;</span><span class="munderover" id="MathJax-Span-530"><span style="display: inline-block; position: relative; width: 7.599em; height: 0px;"><span style="position: absolute; clip: rect(1.829em, 1007.6em, 5.05em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-531"><span class="mrow" id="MathJax-Span-532"><span class="munderover" id="MathJax-Span-533"><span style="display: inline-block; position: relative; width: 7.599em; height: 0px;"><span style="position: absolute; clip: rect(1.829em, 1007.55em, 4.329em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-534"><span class="munderover" id="MathJax-Span-535"><span style="display: inline-block; position: relative; width: 4.714em; height: 0px;"><span style="position: absolute; clip: rect(2.743em, 1004.71em, 4.329em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-536"><span class="mrow" id="MathJax-Span-537"><span class="munderover" id="MathJax-Span-538"><span style="display: inline-block; position: relative; width: 4.714em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1004.67em, 4.329em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-539"><span class="msubsup" id="MathJax-Span-540"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-542"><span class="mrow" id="MathJax-Span-543"><span class="mi" id="MathJax-Span-544" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-545" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-546" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-547" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-548"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-549" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-550"><span class="mrow" id="MathJax-Span-551"><span class="mi" id="MathJax-Span-552" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-553" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-554" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-555" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-556"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-557" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-558"><span class="mrow" id="MathJax-Span-559"><span class="mi" id="MathJax-Span-560" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1004.71em, 2.502em, -999.998em); top: -2.93em; left: 0em;"><span class="mo" id="MathJax-Span-561" style=""><span style="display: inline-block; position: relative; width: 4.714em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 4.233em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 1.877em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.435em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.772em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.156em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.541em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.743em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.127em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.464em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.849em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.224em, 1000.96em, 4.329em, -999.998em); top: -5.382em; left: 1.829em;"><span class="texatom" id="MathJax-Span-562"><span class="mrow" id="MathJax-Span-563"><span class="mi" id="MathJax-Span-564" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-565" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-566" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-567" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-568" style="font-family: MathJax_Main;">&nbsp;</span><span class="munderover" id="MathJax-Span-569"><span style="display: inline-block; position: relative; width: 2.647em; height: 0px;"><span style="position: absolute; clip: rect(2.743em, 1001.68em, 4.329em, -999.998em); top: -3.988em; left: 0.483em;"><span class="texatom" id="MathJax-Span-570"><span class="mrow" id="MathJax-Span-571"><span class="munderover" id="MathJax-Span-572"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1001.68em, 4.329em, -999.998em); top: -3.988em; left: 0.002em;"><span class="msubsup" id="MathJax-Span-573"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-574" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-575"><span class="mrow" id="MathJax-Span-576"><span class="mi" id="MathJax-Span-577" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-578" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-579" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1001.68em, 2.502em, -999.998em); top: -2.93em; left: 0em;"><span class="mo" id="MathJax-Span-580" style=""><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 1.252em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.272em, 1002.6em, 4.233em, -999.998em); top: -5.334em; left: 0em;"><span class="texatom" id="MathJax-Span-581"><span class="mrow" id="MathJax-Span-582"><span class="msubsup" id="MathJax-Span-583"><span style="display: inline-block; position: relative; width: 0.627em; height: 0px;"><span style="position: absolute; clip: rect(3.512em, 1000.29em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-584" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.892em; left: 0.339em;"><span class="mn" id="MathJax-Span-585" style="font-size: 50%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-586" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="msubsup" id="MathJax-Span-587"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px;"><span style="position: absolute; clip: rect(3.512em, 1000.29em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-588" style="font-size: 70.7%; font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.892em; left: 0.339em;"><span class="mi" id="MathJax-Span-589" style="font-size: 50%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-590" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-591" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1007.6em, 2.502em, -999.998em); top: -1.44em; left: 0em;"><span class="mo" id="MathJax-Span-592" style=""><span style="display: inline-block; position: relative; width: 7.599em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 7.166em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 3.368em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.435em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.772em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.156em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.541em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.877em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.262em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.647em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.983em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.185em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.57em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.954em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.291em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.675em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 6.06em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 6.397em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 6.781em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.32em, 1004.38em, 4.425em, -999.998em); top: -2.353em; left: 1.589em;"><span class="texatom" id="MathJax-Span-593"><span class="mrow" id="MathJax-Span-594"><span class="mi" id="MathJax-Span-595" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-596" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-597" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-598" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-599" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-600" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-601" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mi" id="MathJax-Span-602" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-603" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-604" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-605" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-606" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-607" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.559em; border-left: 0px solid; width: 0px; height: 5.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><msub><mi>s</mi><mn>0</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>1</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>2</mn></msub></mrow><mo>⏞</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mover><mtext>&nbsp;</mtext><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><msub><mi>s</mi><mn>3</mn></msub><mo>⏞</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mn>3</mn></msub><mo>=</mo><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mover></mrow><mo>⏟</mo></munder></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>+</mo><mn>1</mn></mrow></munder><mtext>&nbsp;</mtext><mo>…</mo><mtext>&nbsp;</mtext><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>2</mn></mrow></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow><mo>⏞</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mover><mtext>&nbsp;</mtext><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>⏞</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><msub><mi>s</mi><mn>3</mn></msub><mo>=</mo><msub><mi>s</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></mrow></mover></mrow><mo>⏟</mo></munder></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>+</mo><mn>1</mn></mrow></munder></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-41">\underbrace{\overbrace{s_0 ~ s_1 ~ s_2}^{\pi[i]} ~ \overbrace{s_3}^{s_3 = s_{i+1}}}_{\pi[i+1] = \pi[i] + 1} ~ \dots ~ \underbrace{\overbrace{s_{i-2} ~ s_{i-1} ~ s_{i}}^{\pi[i]} ~ \overbrace{s_{i+1}}^{s_3 = s_i + 1}}_{\pi[i+1] = \pi[i] + 1}</script></p>

<p>If this is not the case, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-608" style="width: 9.137em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.022em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1006.92em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-609"><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-611" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-612" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-613" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-614" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-615" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-616" style="font-family: MathJax_Main; padding-left: 0.291em;">≠</span><span class="mi" id="MathJax-Span-617" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">s</span><span class="mo" id="MathJax-Span-618" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-619" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-620" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-621" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-622" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-623" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>≠</mo><mi>s</mi><mo stretchy="false">[</mo><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-42">s[i+1] \neq s[\pi[i]]</script>, then we need to try a shorter string.
In order to speed things up, we would like to immediately move to the longest length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x003C;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-624" style="width: 4.281em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.272em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.17em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-625"><span class="mi" id="MathJax-Span-626" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-627" style="font-family: MathJax_Main; padding-left: 0.291em;">&lt;</span><span class="mi" id="MathJax-Span-628" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-629" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-630" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-631" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>&lt;</mo><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-43">j \lt \pi[i]</script>, such that the prefix property in the position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-632" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-633"><span class="mi" id="MathJax-Span-634" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">i</script> holds, i.e. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-635" style="width: 17.166em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.175em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1013.08em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-636"><span class="mi" id="MathJax-Span-637" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-638" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-639" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-640" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mi" id="MathJax-Span-641" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">j</span><span class="mo" id="MathJax-Span-642" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-643" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-644" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-645" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-646" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">s</span><span class="mo" id="MathJax-Span-647" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-648" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-649" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mi" id="MathJax-Span-650" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">j</span><span class="mo" id="MathJax-Span-651" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-652" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-653" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mi" id="MathJax-Span-654" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">i</span><span class="mo" id="MathJax-Span-655" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mn>0</mn><mo>…</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo>…</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-45">s[0 \dots j-1] = s[i-j+1 \dots i]</script>:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/munder&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/mover&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-656" style="width: 19.474em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.954em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.05em, 1014.95em, 4.185em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-657"><span class="munderover" id="MathJax-Span-658"><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; clip: rect(2.743em, 1004.38em, 5.916em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-659"><span class="mrow" id="MathJax-Span-660"><span class="munderover" id="MathJax-Span-661"><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1004.38em, 5.916em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-662"><span class="munderover" id="MathJax-Span-663"><span style="display: inline-block; position: relative; width: 2.07em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1002.07em, 5.05em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-664"><span class="mrow" id="MathJax-Span-665"><span class="munderover" id="MathJax-Span-666"><span style="display: inline-block; position: relative; width: 2.07em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1002.07em, 4.281em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-667"><span class="msubsup" id="MathJax-Span-668"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-669" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-670" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-671" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-672"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-673" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-674" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1002.07em, 2.502em, -999.998em); top: -1.488em; left: 0em;"><span class="mo" id="MathJax-Span-675" style=""><span style="display: inline-block; position: relative; width: 2.07em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 1.589em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.579em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.339em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.349em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.29em, 4.377em, -999.998em); top: -2.45em; left: 0.868em;"><span class="mi" id="MathJax-Span-676" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-677" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-678"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-679" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-680" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-681" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-682"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-683" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-684" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1004.38em, 2.502em, -999.998em); top: -2.93em; left: 0em;"><span class="mo" id="MathJax-Span-685" style=""><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 3.897em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 1.733em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.724em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.06em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.397em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.55em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.887em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.224em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.56em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.224em, 1000.96em, 4.329em, -999.998em); top: -5.382em; left: 1.685em;"><span class="texatom" id="MathJax-Span-686"><span class="mrow" id="MathJax-Span-687"><span class="mi" id="MathJax-Span-688" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-689" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-690" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-691" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-692" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-693" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mtext" id="MathJax-Span-694" style="font-family: MathJax_Main; padding-left: 0.147em;">&nbsp;</span><span class="munderover" id="MathJax-Span-695"><span style="display: inline-block; position: relative; width: 6.685em; height: 0px;"><span style="position: absolute; clip: rect(2.743em, 1006.68em, 5.964em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-696"><span class="mrow" id="MathJax-Span-697"><span class="munderover" id="MathJax-Span-698"><span style="display: inline-block; position: relative; width: 6.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1006.64em, 5.964em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-699"><span class="msubsup" id="MathJax-Span-700"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-701" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-702"><span class="mrow" id="MathJax-Span-703"><span class="mi" id="MathJax-Span-704" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-705" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-706" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-707" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-708"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-709" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-710"><span class="mrow" id="MathJax-Span-711"><span class="mi" id="MathJax-Span-712" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-713" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-714" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-715" style="font-family: MathJax_Main;">&nbsp;</span><span class="munderover" id="MathJax-Span-716"><span style="display: inline-block; position: relative; width: 2.743em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1002.74em, 5.05em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-717"><span class="mrow" id="MathJax-Span-718"><span class="munderover" id="MathJax-Span-719"><span style="display: inline-block; position: relative; width: 2.743em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1002.74em, 4.329em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-720"><span class="msubsup" id="MathJax-Span-721"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-722" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-723"><span class="mrow" id="MathJax-Span-724"><span class="mi" id="MathJax-Span-725" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-726" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-727" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-728" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-729"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-730" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-731"><span class="mrow" id="MathJax-Span-732"><span class="mi" id="MathJax-Span-733" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1002.74em, 2.502em, -999.998em); top: -1.44em; left: 0em;"><span class="mo" id="MathJax-Span-734" style=""><span style="display: inline-block; position: relative; width: 2.743em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 2.262em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.916em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.339em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.627em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.685em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.974em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.29em, 4.377em, -999.998em); top: -2.401em; left: 1.252em;"><span class="mi" id="MathJax-Span-735" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1006.68em, 2.502em, -999.998em); top: -2.93em; left: 0em;"><span class="mo" id="MathJax-Span-736" style=""><span style="display: inline-block; position: relative; width: 6.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 6.204em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 2.887em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.772em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.108em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.445em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.829em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.166em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.55em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.704em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.089em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.425em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.762em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.147em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.483em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.82em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.224em, 1000.96em, 4.329em, -999.998em); top: -5.382em; left: 2.791em;"><span class="texatom" id="MathJax-Span-737"><span class="mrow" id="MathJax-Span-738"><span class="mi" id="MathJax-Span-739" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-740" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-741" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-742" style="font-size: 70.7%; font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-743" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-744"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-745" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-746"><span class="mrow" id="MathJax-Span-747"><span class="mi" id="MathJax-Span-748" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-749" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-750" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.434em; border-left: 0px solid; width: 0px; height: 5.128em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><msub><mi>s</mi><mn>0</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>1</mn></msub></mrow><mo>⏟</mo></munder></mrow><mi>j</mi></munder><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>2</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>3</mn></msub></mrow><mo>⏞</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mover><mtext>&nbsp;</mtext><mo>…</mo><mtext>&nbsp;</mtext><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>3</mn></mrow></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>2</mn></mrow></msub><mtext>&nbsp;</mtext><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow><mo>⏟</mo></munder></mrow><mi>j</mi></munder></mrow><mo>⏞</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow></mover><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-46">\overbrace{\underbrace{s_0 ~ s_1}_j ~ s_2 ~ s_3}^{\pi[i]} ~ \dots ~ \overbrace{s_{i-3} ~ s_{i-2} ~ \underbrace{s_{i-1} ~ s_{i}}_j}^{\pi[i]} ~ s_{i+1}</script></p>

<p>Indeed, if we find such a length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-751" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.43em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-752"><span class="mi" id="MathJax-Span-753" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">j</script>, then we again only need to compare the characters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-754" style="width: 4.089em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.127em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.03em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-755"><span class="mi" id="MathJax-Span-756" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-757" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-758" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-759" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-760" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-761" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-48">s[i+1]</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-762" style="width: 1.877em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.445em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.35em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-763"><span class="mi" id="MathJax-Span-764" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-765" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-766" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-767" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-49">s[j]</script>.
If they are equal, then we can assign <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-768" style="width: 8.849em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.781em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1006.68em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-769"><span class="mi" id="MathJax-Span-770" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-771" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-772" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-773" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-774" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-775" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-776" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-777" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">j</span><span class="mo" id="MathJax-Span-778" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-779" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>j</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-50">\pi[i+1] = j + 1</script>.
Otherwise we will need to find the largest value smaller than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-780" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.43em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-781"><span class="mi" id="MathJax-Span-782" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">j</script>, for which the prefix property holds, and so on.
It can happen that this goes until <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-783" style="width: 2.935em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.262em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.21em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-784"><span class="mi" id="MathJax-Span-785" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-786" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-787" style="font-family: MathJax_Main; padding-left: 0.291em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-52">j = 0</script>.
If then <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-788" style="width: 7.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.012em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1005.92em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-789"><span class="mi" id="MathJax-Span-790" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-791" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-792" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-793" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-794" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-795" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-796" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-797" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">s</span><span class="mo" id="MathJax-Span-798" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-799" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-800" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>s</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-53">s[i+1] = s[0]</script>, we assign <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-801" style="width: 6.637em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.099em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1005em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-802"><span class="mi" id="MathJax-Span-803" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-804" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-805" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-806" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-807" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-808" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-809" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-810" style="font-family: MathJax_Main; padding-left: 0.291em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-54">\pi[i+1] = 1</script>, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-811" style="width: 6.637em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.099em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1005.05em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-812"><span class="mi" id="MathJax-Span-813" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-814" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-815" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-816" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-817" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-818" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-819" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-820" style="font-family: MathJax_Main; padding-left: 0.291em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-55">\pi[i+1] = 0</script> otherwise.</p>

<p>So we already have a general scheme of the algorithm.
The only question left is how do we effectively find the lengths for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-821" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.43em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-822"><span class="mi" id="MathJax-Span-823" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-56">j</script>.
Let's recap:
for the current length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-824" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.43em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-825"><span class="mi" id="MathJax-Span-826" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">j</script> at the position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-827" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-828"><span class="mi" id="MathJax-Span-829" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">i</script> for which the prefix property holds, i.e. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-830" style="width: 17.166em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.175em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1013.08em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-831"><span class="mi" id="MathJax-Span-832" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-833" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-834" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-835" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mi" id="MathJax-Span-836" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">j</span><span class="mo" id="MathJax-Span-837" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-838" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-839" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-840" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-841" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">s</span><span class="mo" id="MathJax-Span-842" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-843" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-844" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mi" id="MathJax-Span-845" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">j</span><span class="mo" id="MathJax-Span-846" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-847" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-848" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mi" id="MathJax-Span-849" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">i</span><span class="mo" id="MathJax-Span-850" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mn>0</mn><mo>…</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mi>j</mi><mo>+</mo><mn>1</mn><mo>…</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-59">s[0 \dots j-1] = s[i-j+1 \dots i]</script>, we want to find the greatest <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x003C;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-851" style="width: 3.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.31em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.31em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-852"><span class="mi" id="MathJax-Span-853" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-854" style="font-family: MathJax_Main; padding-left: 0.291em;">&lt;</span><span class="mi" id="MathJax-Span-855" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">j</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>&lt;</mo><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">k \lt j</script>, for which the prefix property holds.
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mrow&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munder&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mover&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mover&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-856" style="width: 19.474em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.954em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.147em, 1014.95em, 4.041em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-857"><span class="munderover" id="MathJax-Span-858"><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; clip: rect(2.743em, 1004.38em, 5.772em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-859"><span class="mrow" id="MathJax-Span-860"><span class="munderover" id="MathJax-Span-861"><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1004.38em, 5.772em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-862"><span class="munderover" id="MathJax-Span-863"><span style="display: inline-block; position: relative; width: 2.07em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1002.07em, 5.05em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-864"><span class="mrow" id="MathJax-Span-865"><span class="munderover" id="MathJax-Span-866"><span style="display: inline-block; position: relative; width: 2.07em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1002.07em, 4.281em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-867"><span class="msubsup" id="MathJax-Span-868"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-869" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-870" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-871" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-872"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-873" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-874" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1002.07em, 2.502em, -999.998em); top: -1.488em; left: 0em;"><span class="mo" id="MathJax-Span-875" style=""><span style="display: inline-block; position: relative; width: 2.07em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 1.589em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.579em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.339em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.349em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.34em, 4.233em, -999.998em); top: -2.45em; left: 0.868em;"><span class="mi" id="MathJax-Span-876" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-877" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-878"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-879" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-880" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-881" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-882"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-883" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-884" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1004.38em, 2.502em, -999.998em); top: -2.93em; left: 0em;"><span class="mo" id="MathJax-Span-885" style=""><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 3.897em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 1.733em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.724em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.06em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.397em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.55em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.887em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.224em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.56em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.272em, 1000.29em, 4.281em, -999.998em); top: -5.334em; left: 2.07em;"><span class="mi" id="MathJax-Span-886" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-887" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-888" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mtext" id="MathJax-Span-889" style="font-family: MathJax_Main; padding-left: 0.147em;">&nbsp;</span><span class="munderover" id="MathJax-Span-890"><span style="display: inline-block; position: relative; width: 6.685em; height: 0px;"><span style="position: absolute; clip: rect(2.743em, 1006.68em, 5.82em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-891"><span class="mrow" id="MathJax-Span-892"><span class="munderover" id="MathJax-Span-893"><span style="display: inline-block; position: relative; width: 6.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1006.64em, 5.82em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-894"><span class="msubsup" id="MathJax-Span-895"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-896" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-897"><span class="mrow" id="MathJax-Span-898"><span class="mi" id="MathJax-Span-899" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-900" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-901" style="font-size: 70.7%; font-family: MathJax_Main;">3</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-902" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-903"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-904" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-905"><span class="mrow" id="MathJax-Span-906"><span class="mi" id="MathJax-Span-907" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-908" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-909" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-910" style="font-family: MathJax_Main;">&nbsp;</span><span class="munderover" id="MathJax-Span-911"><span style="display: inline-block; position: relative; width: 2.743em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1002.74em, 5.05em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-912"><span class="mrow" id="MathJax-Span-913"><span class="munderover" id="MathJax-Span-914"><span style="display: inline-block; position: relative; width: 2.743em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1002.74em, 4.329em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-915"><span class="msubsup" id="MathJax-Span-916"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-917" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-918"><span class="mrow" id="MathJax-Span-919"><span class="mi" id="MathJax-Span-920" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-921" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-922" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-923" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-924"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-925" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-926"><span class="mrow" id="MathJax-Span-927"><span class="mi" id="MathJax-Span-928" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1002.74em, 2.502em, -999.998em); top: -1.44em; left: 0em;"><span class="mo" id="MathJax-Span-929" style=""><span style="display: inline-block; position: relative; width: 2.743em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 2.262em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.916em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.339em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.627em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.685em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.974em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.34em, 4.233em, -999.998em); top: -2.401em; left: 1.204em;"><span class="mi" id="MathJax-Span-930" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1006.68em, 2.502em, -999.998em); top: -2.93em; left: 0em;"><span class="mo" id="MathJax-Span-931" style=""><span style="display: inline-block; position: relative; width: 6.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 6.204em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 2.887em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.772em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.108em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.445em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.829em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.166em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.55em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.704em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.089em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.425em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.762em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.147em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.483em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.82em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.272em, 1000.29em, 4.281em, -999.998em); top: -5.334em; left: 3.175em;"><span class="mi" id="MathJax-Span-932" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-933" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-934"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-935" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-936"><span class="mrow" id="MathJax-Span-937"><span class="mi" id="MathJax-Span-938" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-939" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-940" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.247em; border-left: 0px solid; width: 0px; height: 4.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><msub><mi>s</mi><mn>0</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>1</mn></msub></mrow><mo>⏟</mo></munder></mrow><mi>k</mi></munder><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>2</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>3</mn></msub></mrow><mo>⏞</mo></mover></mrow><mi>j</mi></mover><mtext>&nbsp;</mtext><mo>…</mo><mtext>&nbsp;</mtext><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>3</mn></mrow></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>2</mn></mrow></msub><mtext>&nbsp;</mtext><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></mrow><mo>⏟</mo></munder></mrow><mi>k</mi></munder></mrow><mo>⏞</mo></mover></mrow><mi>j</mi></mover><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-61">\overbrace{\underbrace{s_0 ~ s_1}_k ~ s_2 ~ s_3}^j ~ \dots ~ \overbrace{s_{i-3} ~ s_{i-2} ~ \underbrace{s_{i-1} ~ s_{i}}_k}^j ~s_{i+1}</script></p>

<p>The illustration shows, that this has to be the value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-941" style="width: 4.329em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.32em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.22em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-942"><span class="mi" id="MathJax-Span-943" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-944" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-945" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-946" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-947" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-948" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-62">\pi[j-1]</script>, which we already calculated earlier.</p>

<h3 id="toc-tgt-5">Final algorithm</h3>

<p>So we finally can build an algorithm that doesn't perform any string comparisons and only performs <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-949" style="width: 2.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.166em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1002.07em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-950"><span class="mi" id="MathJax-Span-951" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-952" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-953" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-954" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-63">O(n)</script> actions.</p>

<p>Here is the final procedure:</p>

<ul>
<li>We compute the prefix values <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-955" style="width: 1.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.4em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-956"><span class="mi" id="MathJax-Span-957" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-958" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-959" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-960" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-64">\pi[i]</script> in a loop by iterating from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-961" style="width: 2.887em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.214em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.12em, 2.358em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-962"><span class="mi" id="MathJax-Span-963" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-964" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-965" style="font-family: MathJax_Main; padding-left: 0.291em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-65">i = 1</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-966" style="width: 5.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.089em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1003.99em, 2.454em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-967"><span class="mi" id="MathJax-Span-968" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-969" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-970" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">n</span><span class="mo" id="MathJax-Span-971" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-972" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>=</mo><mi>n</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-66">i = n-1</script> (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-973" style="width: 2.166em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.637em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.54em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-974"><span class="mi" id="MathJax-Span-975" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-976" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-977" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-978" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-67">\pi[0]</script> just gets assigned with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-979" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.43em, 2.358em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-980"><span class="mn" id="MathJax-Span-981" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-68">0</script>).</li>
<li>To calculate the current value <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-982" style="width: 1.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.4em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-983"><span class="mi" id="MathJax-Span-984" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-985" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-986" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-987" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-69">\pi[i]</script> we set the variable <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-988" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.43em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-989"><span class="mi" id="MathJax-Span-990" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-70">j</script> denoting the length of the best suffix for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-991" style="width: 2.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.118em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.02em, 2.454em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-992"><span class="mi" id="MathJax-Span-993" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-994" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-995" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-71">i-1</script>. Initially <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-996" style="width: 6.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.002em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1004.91em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-997"><span class="mi" id="MathJax-Span-998" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-999" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-1000" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1001" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1002" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1003" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-1004" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-1005" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>=</mo><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-72">j = \pi[i-1]</script>.</li>
<li>Test if the suffix of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1006" style="width: 2.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.166em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.07em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1007"><span class="mi" id="MathJax-Span-1008" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1009" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-1010" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-73">j+1</script> is also a prefix by comparing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1011" style="width: 1.877em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.445em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.35em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1012"><span class="mi" id="MathJax-Span-1013" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1014" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1015" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1016" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-74">s[j]</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1017" style="width: 1.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.397em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.3em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1018"><span class="mi" id="MathJax-Span-1019" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1020" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1021" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1022" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-75">s[i]</script>.
If they are equal then we assign <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1023" style="width: 6.541em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.002em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1004.91em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1024"><span class="mi" id="MathJax-Span-1025" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1026" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1027" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1028" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1029" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-1030" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">j</span><span class="mo" id="MathJax-Span-1031" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-1032" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>j</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-76">\pi[i] = j + 1</script>, otherwise we reduce <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1033" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.43em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1034"><span class="mi" id="MathJax-Span-1035" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-77">j</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1036" style="width: 4.329em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.32em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.22em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1037"><span class="mi" id="MathJax-Span-1038" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1039" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1040" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1041" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-1042" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-1043" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-78">\pi[j-1]</script> and repeat this step.</li>
<li>If we have reached the length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1044" style="width: 2.935em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.262em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.21em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1045"><span class="mi" id="MathJax-Span-1046" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1047" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-1048" style="font-family: MathJax_Main; padding-left: 0.291em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-79">j = 0</script> and still don't have a match, then we assign <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1049" style="width: 4.329em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.32em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.27em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1050"><span class="mi" id="MathJax-Span-1051" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1052" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1053" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1054" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1055" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-1056" style="font-family: MathJax_Main; padding-left: 0.291em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-80">\pi[i] = 0</script> and go to the next index <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1057" style="width: 2.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.118em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.02em, 2.454em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1058"><span class="mi" id="MathJax-Span-1059" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1060" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-1061" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-81">i + 1</script>.</li>
</ul>

<h3 id="toc-tgt-6">Implementation</h3>

<p>The implementation ends up being surprisingly short and expressive.</p>

<pre><code class="cpp hljs"><span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span> prefix_function(<span class="hljs-built_in">string</span> s) {
    <span class="hljs-keyword">int</span> n = (<span class="hljs-keyword">int</span>)s.length();
    <span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span> pi(n);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; n; i++) {
        <span class="hljs-keyword">int</span> j = pi[i-<span class="hljs-number">1</span>];
        <span class="hljs-keyword">while</span> (j &gt; <span class="hljs-number">0</span> &amp;&amp; s[i] != s[j])
            j = pi[j-<span class="hljs-number">1</span>];
        <span class="hljs-keyword">if</span> (s[i] == s[j])
            j++;
        pi[i] = j;
    }
    <span class="hljs-keyword">return</span> pi;
}
</code></pre>

<p>This is an <strong>online</strong> algorithm, i.e. it processes the data as it arrives - for example, you can read the string characters one by one and process them immediately, finding the value of prefix function for each next character.
The algorithm still requires storing the string itself and the previously calculated values of prefix function, but if we know beforehand the maximum value <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1062" style="width: 1.397em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.06em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1001.06em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1063"><span class="mi" id="MathJax-Span-1064" style="font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.099em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-82">M</script> the prefix function can take on the string, we can store only <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;M&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1065" style="width: 3.704em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.839em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.74em, 2.454em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1066"><span class="mi" id="MathJax-Span-1067" style="font-family: MathJax_Math-italic;">M<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.099em;"></span></span><span class="mo" id="MathJax-Span-1068" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-1069" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-83">M+1</script> first characters of the string and the same number of values of the prefix function.</p>

<h2 id="toc-tgt-7">Applications</h2>

<h3 id="toc-tgt-8">Search for a substring in a string. The Knuth-Morris-Pratt algorithm</h3>

<p>The task is the classical application of the prefix function.</p>

<p>Given a text <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1070" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1071"><span class="mi" id="MathJax-Span-1072" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-84">t</script> and a string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1073" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1074"><span class="mi" id="MathJax-Span-1075" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">s</script>, we want to find and display the positions of all occurrences of the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1076" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1077"><span class="mi" id="MathJax-Span-1078" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-86">s</script> in the text <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1079" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1080"><span class="mi" id="MathJax-Span-1081" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-87">t</script>.</p>

<p>For convenience we denote with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1082" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1083"><span class="mi" id="MathJax-Span-1084" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-88">n</script> the length of the string s and with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1085" style="width: 1.156em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.868em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.87em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1086"><span class="mi" id="MathJax-Span-1087" style="font-family: MathJax_Math-italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-89">m</script> the length of the text <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1088" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1089"><span class="mi" id="MathJax-Span-1090" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-90">t</script>.</p>

<p>We generate the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1091" style="width: 5.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.185em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1004.14em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1092"><span class="mi" id="MathJax-Span-1093" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1094" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1095" style="font-family: MathJax_Main; padding-left: 0.243em;">#</span><span class="mo" id="MathJax-Span-1096" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1097" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">t</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>+</mo><mi mathvariant="normal">#</mi><mo>+</mo><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">s + \# + t</script>, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1098" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.77em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1099"><span class="mi" id="MathJax-Span-1100" style="font-family: MathJax_Main;">#</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">#</mi></math></span></span><script type="math/tex" id="MathJax-Element-92">\#</script> is a separator that appears neither in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1101" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1102"><span class="mi" id="MathJax-Span-1103" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-93">s</script> nor in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1104" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1105"><span class="mi" id="MathJax-Span-1106" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-94">t</script>.
Let us calculate the prefix function for this string.
Now think about the meaning of the values of the prefix function, except for the first <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1107" style="width: 3.079em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.358em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.26em, 2.454em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1108"><span class="mi" id="MathJax-Span-1109" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1110" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-1111" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-95">n + 1</script> entries (which belong to the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1112" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1113"><span class="mi" id="MathJax-Span-1114" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-96">s</script> and the separator).
By definition the value <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1115" style="width: 1.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.4em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1116"><span class="mi" id="MathJax-Span-1117" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1118" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1119" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1120" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-97">\pi[i]</script> shows the longest length of a substring ending in position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1121" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1122"><span class="mi" id="MathJax-Span-1123" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-98">i</script> that coincides with the prefix.
But in our case this is nothing more than the largest block that coincides with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1124" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1125"><span class="mi" id="MathJax-Span-1126" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-99">s</script> and ends at position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1127" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1128"><span class="mi" id="MathJax-Span-1129" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-100">i</script>.
This length cannot be bigger than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1130" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1131"><span class="mi" id="MathJax-Span-1132" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-101">n</script> due to the separator.
But if equality <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1133" style="width: 4.474em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.416em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.42em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1134"><span class="mi" id="MathJax-Span-1135" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1136" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1137" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1138" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1139" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-1140" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-102">\pi[i] = n</script> is achieved, then it means that the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1141" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1142"><span class="mi" id="MathJax-Span-1143" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-103">s</script> appears completely in at this position, i.e. it ends at position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1144" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1145"><span class="mi" id="MathJax-Span-1146" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-104">i</script>.
Just do not forget that the positions are indexed in the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1147" style="width: 5.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.185em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1004.14em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1148"><span class="mi" id="MathJax-Span-1149" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1150" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1151" style="font-family: MathJax_Main; padding-left: 0.243em;">#</span><span class="mo" id="MathJax-Span-1152" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1153" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">t</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>+</mo><mi mathvariant="normal">#</mi><mo>+</mo><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-105">s + \# + t</script>.</p>

<p>Thus if at some position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1154" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1155"><span class="mi" id="MathJax-Span-1156" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-106">i</script> we have <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1157" style="width: 4.474em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.416em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.42em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1158"><span class="mi" id="MathJax-Span-1159" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1160" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1161" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1162" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1163" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-1164" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>=</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-107">\pi[i] = n</script>, then at the position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1165" style="width: 16.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.454em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1012.45em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1166"><span class="mi" id="MathJax-Span-1167" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1168" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mo" id="MathJax-Span-1169" style="font-family: MathJax_Main; padding-left: 0.243em;">(</span><span class="mi" id="MathJax-Span-1170" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1171" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-1172" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-1173" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1174" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mi" id="MathJax-Span-1175" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">n</span><span class="mo" id="MathJax-Span-1176" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-1177" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-1178" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-1179" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">i</span><span class="mo" id="MathJax-Span-1180" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-1181" style="font-family: MathJax_Main; padding-left: 0.243em;">2</span><span class="mi" id="MathJax-Span-1182" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>−</mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>−</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo>=</mo><mi>i</mi><mo>−</mo><mn>2</mn><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-108">i - (n + 1) - n + 1 = i - 2n</script> in the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1183" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1184"><span class="mi" id="MathJax-Span-1185" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-109">t</script> the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1186" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1187"><span class="mi" id="MathJax-Span-1188" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-110">s</script> appears.</p>

<p>As already mentioned in the description of the prefix function computation, if we know that the prefix values never exceed a certain value, then we do not need to store the entire string and the entire function, but only its beginning.
In our case this means that we only need to store the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1189" style="width: 3.32em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.55em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.5em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1190"><span class="mi" id="MathJax-Span-1191" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1192" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1193" style="font-family: MathJax_Main; padding-left: 0.243em;">#</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>+</mo><mi mathvariant="normal">#</mi></math></span></span><script type="math/tex" id="MathJax-Element-111">s + \#</script> and the values of the prefix function for it.
We can read one character at a time of the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1194" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1195"><span class="mi" id="MathJax-Span-1196" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-112">t</script> and calculate the current value of the prefix function.</p>

<p>Thus the Knuth-Morris-Pratt algorithm solves the problem in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1197" style="width: 5.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.281em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1004.18em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1198"><span class="mi" id="MathJax-Span-1199" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1200" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1201" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1202" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1203" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">m</span><span class="mo" id="MathJax-Span-1204" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-113">O(n + m)</script> time and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1205" style="width: 2.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.166em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1002.07em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1206"><span class="mi" id="MathJax-Span-1207" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1208" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1209" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1210" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-114">O(n)</script> memory.</p>

<h3 id="toc-tgt-9">Counting the number of occurrences of each prefix</h3>

<p>Here we discuss two problems at once.
Given a string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1211" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1212"><span class="mi" id="MathJax-Span-1213" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-115">s</script> of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1214" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1215"><span class="mi" id="MathJax-Span-1216" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-116">n</script>.
In the first variation of the problem we want to count the number of appearances of each prefix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1217" style="width: 4.329em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.32em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.22em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1218"><span class="mi" id="MathJax-Span-1219" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1220" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-1221" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1222" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mi" id="MathJax-Span-1223" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">i</span><span class="mo" id="MathJax-Span-1224" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mn>0</mn><mo>…</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-117">s[0 \dots i]</script> in the same string.
In the second variation of the problem another string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1225" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1226"><span class="mi" id="MathJax-Span-1227" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-118">t</script> is given and we want to count the number of appearances of each prefix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1228" style="width: 4.329em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.32em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.22em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1229"><span class="mi" id="MathJax-Span-1230" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1231" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-1232" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1233" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mi" id="MathJax-Span-1234" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">i</span><span class="mo" id="MathJax-Span-1235" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo stretchy="false">[</mo><mn>0</mn><mo>…</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-119">s[0 \dots i]</script> in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1236" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1237"><span class="mi" id="MathJax-Span-1238" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-120">t</script>.</p>

<p>First we solve the first problem.
Consider the value of the prefix function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1239" style="width: 1.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.4em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1240"><span class="mi" id="MathJax-Span-1241" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1242" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1243" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1244" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-121">\pi[i]</script> at a position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1245" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1246"><span class="mi" id="MathJax-Span-1247" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-122">i</script>.
By definition it means that in position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1248" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1249"><span class="mi" id="MathJax-Span-1250" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-123">i</script> the prefix of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1251" style="width: 1.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.4em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1252"><span class="mi" id="MathJax-Span-1253" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1254" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1255" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1256" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-124">\pi[i]</script> of the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1257" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1258"><span class="mi" id="MathJax-Span-1259" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-125">s</script> appears and ends at position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1260" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1261"><span class="mi" id="MathJax-Span-1262" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-126">i</script>, and there doesn't exists a longer prefix that follows this definition.
At the same time shorter prefixes can end at this position.
It is not difficult to see, that we have the same question that we already answered when we computed the prefix function itself:
Given a prefix of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1263" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.43em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1264"><span class="mi" id="MathJax-Span-1265" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-127">j</script> that is a suffix ending at position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1266" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1267"><span class="mi" id="MathJax-Span-1268" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-128">i</script>, what is the next smaller prefix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x003C;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1269" style="width: 1.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1001.49em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1270"><span class="mo" id="MathJax-Span-1271" style="font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-1272" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">j</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&lt;</mo><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-129">\lt j</script> that is also a suffix ending at position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1273" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1274"><span class="mi" id="MathJax-Span-1275" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-130">i</script>.
Thus at the position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1276" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1277"><span class="mi" id="MathJax-Span-1278" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-131">i</script> ends the prefix of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1279" style="width: 1.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.4em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1280"><span class="mi" id="MathJax-Span-1281" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1282" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1283" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1284" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-132">\pi[i]</script>, the prefix of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1285" style="width: 5.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.377em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1004.28em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1286"><span class="mi" id="MathJax-Span-1287" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1288" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1290" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1291" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1292" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1293" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-1294" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-1295" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-133">\pi[\pi[i] - 1]</script>, the prefix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1296" style="width: 9.474em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.262em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1007.17em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1297"><span class="mi" id="MathJax-Span-1298" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1299" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1300" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1301" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1302" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1303" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1304" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1305" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1306" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-1307" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-1308" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1309" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-1310" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-1311" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>π</mi><mo stretchy="false">[</mo><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-134">\pi[\pi[\pi[i] - 1] - 1]</script>, and so on, until the index becomes zero.
Thus we can compute the answer in the following way.</p>

<pre><code class="cpp hljs"><span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span> ans(n + <span class="hljs-number">1</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++)
    ans[pi[i]]++;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n-<span class="hljs-number">1</span>; i &gt; <span class="hljs-number">0</span>; i--)
    ans[pi[i-<span class="hljs-number">1</span>]] += ans[i];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt;= n; i++)
    ans[i]++;
</code></pre>

<p>Here for each value of the prefix function we first count how many times it occurs in the array <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1312" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1313"><span class="mi" id="MathJax-Span-1314" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-135">\pi</script>, and then compute the final answers:
if we know that the length prefix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1315" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1316"><span class="mi" id="MathJax-Span-1317" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-136">i</script> appears exactly <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;ans&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1318" style="width: 3.079em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.358em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1002.26em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1319"><span class="mtext" id="MathJax-Span-1320" style="font-family: MathJax_Main;">ans</span><span class="mo" id="MathJax-Span-1321" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1322" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1323" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>ans</mtext><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-137">\text{ans}[i]</script> times, then this number must be added to the number of occurrences of its longest suffix that is also a prefix.
At the end we need to add <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1324" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.39em, 2.358em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1325"><span class="mn" id="MathJax-Span-1326" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-138">1</script> to each result, since we also need to count the original prefixes also.</p>

<p>Now let us consider the second problem.
We apply the trick from Knuth-Morris-Pratt:
we create the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1327" style="width: 5.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.185em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1004.14em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1328"><span class="mi" id="MathJax-Span-1329" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1330" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1331" style="font-family: MathJax_Main; padding-left: 0.243em;">#</span><span class="mo" id="MathJax-Span-1332" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1333" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">t</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>+</mo><mi mathvariant="normal">#</mi><mo>+</mo><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-139">s + \# + t</script> and compute its prefix function.
The only differences to the first task is, that we are only interested in the prefix values that relate to the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1334" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1335"><span class="mi" id="MathJax-Span-1336" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-140">t</script>, i.e. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1337" style="width: 1.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.4em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1338"><span class="mi" id="MathJax-Span-1339" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1340" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1341" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1342" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-141">\pi[i]</script> for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1343" style="width: 5.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.089em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1003.99em, 2.502em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1344"><span class="mi" id="MathJax-Span-1345" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1346" style="font-family: MathJax_Main; padding-left: 0.291em;">≥</span><span class="mi" id="MathJax-Span-1347" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">n</span><span class="mo" id="MathJax-Span-1348" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-1349" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>≥</mo><mi>n</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-142">i \ge n + 1</script>.
With those values we can perform the exact same computations as in the first task.</p>

<h3 id="toc-tgt-10">The number of different substring in a string</h3>

<p>Given a string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1350" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1351"><span class="mi" id="MathJax-Span-1352" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-143">s</script> of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1353" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1354"><span class="mi" id="MathJax-Span-1355" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-144">n</script>.
We want to compute the number of different substrings appearing in it.</p>

<p>We will solve this problem iteratively.
Namely we will learn, knowing the current number of different substrings, how to recompute this count by adding a character to the end.</p>

<p>So let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1356" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1357"><span class="mi" id="MathJax-Span-1358" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-145">k</script> be the current number of different substrings in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1359" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1360"><span class="mi" id="MathJax-Span-1361" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-146">s</script>, and we add the character <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1362" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1363"><span class="mi" id="MathJax-Span-1364" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-147">c</script> to the end of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1365" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1366"><span class="mi" id="MathJax-Span-1367" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-148">s</script>.
Obviously some new substrings ending in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1368" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1369"><span class="mi" id="MathJax-Span-1370" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-149">c</script> will appear.
We want to count these new substrings that didn't appear before.</p>

<p>We take the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1371" style="width: 5.099em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.897em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.445em, 1003.9em, 2.454em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1372"><span class="mi" id="MathJax-Span-1373" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1374" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-1375" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">s</span><span class="mo" id="MathJax-Span-1376" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1377" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">c</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>=</mo><mi>s</mi><mo>+</mo><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-150">t = s + c</script> and reverse it.
Now the task is transformed into computing how many prefixes there are that don't appear anywhere else.
If we compute the maximal value of the prefix function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1378" style="width: 2.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.974em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1001.97em, 2.454em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1379"><span class="msubsup" id="MathJax-Span-1380"><span style="display: inline-block; position: relative; width: 1.974em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.58em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1381" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.579em;"><span class="texatom" id="MathJax-Span-1382"><span class="mrow" id="MathJax-Span-1383"><span class="mtext" id="MathJax-Span-1384" style="font-size: 70.7%; font-family: MathJax_Main;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-151">\pi_{\text{max}}</script> of the reversed string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1385" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1386"><span class="mi" id="MathJax-Span-1387" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-152">t</script>, then the longest prefix that appears in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1388" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1389"><span class="mi" id="MathJax-Span-1390" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-153">s</script> is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1391" style="width: 2.599em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.974em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1001.97em, 2.454em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1392"><span class="msubsup" id="MathJax-Span-1393"><span style="display: inline-block; position: relative; width: 1.974em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.58em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1394" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.579em;"><span class="texatom" id="MathJax-Span-1395"><span class="mrow" id="MathJax-Span-1396"><span class="mtext" id="MathJax-Span-1397" style="font-size: 70.7%; font-family: MathJax_Main;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-154">\pi_{\text{max}}</script> long.
Clearly also all prefixes of smaller length appear in it.</p>

<p>Therefore the number of new substrings appearing when we add a new character <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1398" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1399"><span class="mi" id="MathJax-Span-1400" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-155">c</script> is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1401" style="width: 7.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.012em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1006.01em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1402"><span class="texatom" id="MathJax-Span-1403"><span class="mrow" id="MathJax-Span-1404"><span class="mo" id="MathJax-Span-1405" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1406" style="font-family: MathJax_Math-italic;">s</span><span class="texatom" id="MathJax-Span-1407"><span class="mrow" id="MathJax-Span-1408"><span class="mo" id="MathJax-Span-1409" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1410" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mn" id="MathJax-Span-1411" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-1412" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="msubsup" id="MathJax-Span-1413" style="padding-left: 0.243em;"><span style="display: inline-block; position: relative; width: 1.974em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.58em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1414" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.579em;"><span class="texatom" id="MathJax-Span-1415"><span class="mrow" id="MathJax-Span-1416"><span class="mtext" id="MathJax-Span-1417" style="font-size: 70.7%; font-family: MathJax_Main;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mn>1</mn><mo>−</mo><msub><mi>π</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-156">|s| + 1 - \pi_{\text{max}}</script>.</p>

<p>So for each character appended we can compute the number of new substrings in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1418" style="width: 2.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.166em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1002.07em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1419"><span class="mi" id="MathJax-Span-1420" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1421" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1422" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1423" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-157">O(n)</script> times, which gives a time complexity of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1424" style="width: 3.32em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.55em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.252em, 1002.45em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1425"><span class="mi" id="MathJax-Span-1426" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1427" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1428"><span style="display: inline-block; position: relative; width: 1.012em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.58em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1429" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.579em;"><span class="mn" id="MathJax-Span-1430" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-1431" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-158">O(n^2)</script> in total.</p>

<p>It is worth noting, that we can also compute the number of different substrings by appending the characters at the beginning, or by deleting characters from the beginning or the end.</p>

<h3 id="toc-tgt-11">Compressing a string</h3>

<p>Given a string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-159-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1432" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1433"><span class="mi" id="MathJax-Span-1434" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-159">s</script> of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1435" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1436"><span class="mi" id="MathJax-Span-1437" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-160">n</script>.
We want to find the shortest "compressed" representation of the string, i.e. we want to find a string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1438" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1439"><span class="mi" id="MathJax-Span-1440" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-161">t</script> of smallest length such that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1441" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1442"><span class="mi" id="MathJax-Span-1443" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-162">s</script> can be represented as a concatenation of one or more copies of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1444" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1445"><span class="mi" id="MathJax-Span-1446" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-163">t</script>.</p>

<p>It is clear, that we only need to find the length of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-164-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1447" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1448"><span class="mi" id="MathJax-Span-1449" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-164">t</script>. Knowing the length, the answer to the problem will be the prefix of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-165-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1450" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1451"><span class="mi" id="MathJax-Span-1452" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-165">s</script> with this length.</p>

<p>Let us compute the prefix function for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-166-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1453" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1454"><span class="mi" id="MathJax-Span-1455" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-166">s</script>.
Using the last value of it we define the value <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-167-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1456" style="width: 9.474em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.262em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1007.17em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1457"><span class="mi" id="MathJax-Span-1458" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1459" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-1460" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">n</span><span class="mo" id="MathJax-Span-1461" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mi" id="MathJax-Span-1462" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1463" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1464" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1465" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-1466" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-1467" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mi>n</mi><mo>−</mo><mi>π</mi><mo stretchy="false">[</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-167">k = n - \pi[n - 1]</script>.
We will show, that if <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-168-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1468" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1469"><span class="mi" id="MathJax-Span-1470" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-168">k</script> divides <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1471" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1472"><span class="mi" id="MathJax-Span-1473" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-169">n</script>, then <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1474" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1475"><span class="mi" id="MathJax-Span-1476" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-170">k</script> will be the answer, otherwise there doesn't exists an effective compression and the answer is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1477" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1478"><span class="mi" id="MathJax-Span-1479" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-171">n</script>.</p>

<p>Let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1480" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1481"><span class="mi" id="MathJax-Span-1482" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-172">n</script> be divisible by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-173-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1483" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1484"><span class="mi" id="MathJax-Span-1485" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-173">k</script>.
Then the string can be partitioned into blocks of the length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-174-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1486" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1487"><span class="mi" id="MathJax-Span-1488" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-174">k</script>.
By definition of the prefix function, the prefix of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-175-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1489" style="width: 3.127em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.406em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.41em, 2.454em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1490"><span class="mi" id="MathJax-Span-1491" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1492" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mi" id="MathJax-Span-1493" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">k</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>−</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-175">n - k</script> will be equal with its suffix.
But this means that the last block is equal to the block before.
And the block before has to be equal to the block before it.
And so on.
As a result, it turns out that all blocks are equal, therefore we can compress the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1494" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1495"><span class="mi" id="MathJax-Span-1496" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-176">s</script> to length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1497" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1498"><span class="mi" id="MathJax-Span-1499" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-177">k</script>.</p>

<p>Of course we still need to show that this is actually the optimum.
Indeed, if there was a smaller compression than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1500" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1501"><span class="mi" id="MathJax-Span-1502" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-178">k</script>, than the prefix function at the end would be greater than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-179-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1503" style="width: 3.127em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.406em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.41em, 2.454em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1504"><span class="mi" id="MathJax-Span-1505" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1506" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mi" id="MathJax-Span-1507" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">k</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>−</mo><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-179">n - k</script>.
Therefore <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1508" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1509"><span class="mi" id="MathJax-Span-1510" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-180">k</script> is really the answer.</p>

<p>Now let us assume that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-181-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1511" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1512"><span class="mi" id="MathJax-Span-1513" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-181">n</script> is not divisible by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-182-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1514" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1515"><span class="mi" id="MathJax-Span-1516" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-182">k</script>.
We show that this implies that the length of the answer is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-183-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1517" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1518"><span class="mi" id="MathJax-Span-1519" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-183">n</script>.
We prove it by contradiction.
Assuming there exists an answer, and the compression has length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-184-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1520" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.48em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1521"><span class="mi" id="MathJax-Span-1522" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-184">p</script> (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-185-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1523" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.48em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1524"><span class="mi" id="MathJax-Span-1525" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-185">p</script> divides <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-186-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1526" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1527"><span class="mi" id="MathJax-Span-1528" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-186">n</script>).
Then the last value of the prefix function has to be greater than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-187-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1529" style="width: 3.079em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.358em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.493em, 1002.36em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1530"><span class="mi" id="MathJax-Span-1531" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1532" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mi" id="MathJax-Span-1533" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>−</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-187">n - p</script>, i.e. the suffix will partially cover the first block.
Now consider the second block of the string.
Since the prefix is equal with the suffix, and both the prefix and the suffix cover this block and their displacement relative to each other <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-188-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1534" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1535"><span class="mi" id="MathJax-Span-1536" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-188">k</script> does not divide the block length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-189-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1537" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.48em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1538"><span class="mi" id="MathJax-Span-1539" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-189">p</script> (otherwise <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-190-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1540" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1541"><span class="mi" id="MathJax-Span-1542" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-190">k</script> divides <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-191-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1543" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1544"><span class="mi" id="MathJax-Span-1545" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-191">n</script>), then all the characters of the block have to be identical.
But then the string consists of only one character repeated over and over, hence we can compress it to a string of size <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-192-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1546" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.39em, 2.358em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1547"><span class="mn" id="MathJax-Span-1548" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-192">1</script>, which gives <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-193-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1549" style="width: 3.127em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.406em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.31em, 2.358em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1550"><span class="mi" id="MathJax-Span-1551" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1552" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-1553" style="font-family: MathJax_Main; padding-left: 0.291em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-193">k = 1</script>, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-194-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1554" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1555"><span class="mi" id="MathJax-Span-1556" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-194">k</script> divides <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-195-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1557" style="width: 0.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.579em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.58em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1558"><span class="mi" id="MathJax-Span-1559" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-195">n</script>.
Contradiction.</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-196-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mover&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mover&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1560" style="width: 11.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.993em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.291em, 1008.99em, 2.502em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1561"><span class="munderover" id="MathJax-Span-1562"><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; clip: rect(2.743em, 1004.38em, 4.281em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-1563"><span class="mrow" id="MathJax-Span-1564"><span class="munderover" id="MathJax-Span-1565"><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1004.33em, 4.281em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1566"><span class="msubsup" id="MathJax-Span-1567"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1568" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1569" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1570" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1571"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1572" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1573" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1574" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1575"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1576" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1577" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1578" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1579"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1580" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1581" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1004.38em, 2.502em, -999.998em); top: -2.93em; left: 0em;"><span class="mo" id="MathJax-Span-1582" style=""><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 3.897em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 1.733em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.724em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.06em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.397em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.55em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.887em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.224em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.56em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.416em, 1000.34em, 4.281em, -999.998em); top: -5.334em; left: 2.022em;"><span class="mi" id="MathJax-Span-1583" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1584" style="font-family: MathJax_Main;">&nbsp;</span><span class="munderover" id="MathJax-Span-1585"><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; clip: rect(2.743em, 1004.38em, 4.281em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-1586"><span class="mrow" id="MathJax-Span-1587"><span class="munderover" id="MathJax-Span-1588"><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1004.33em, 4.281em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1589"><span class="msubsup" id="MathJax-Span-1590"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1591" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1592" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1593" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1594"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1595" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1596" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1597" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1598"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1599" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1600" style="font-size: 70.7%; font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1601" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1602"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1603" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1604" style="font-size: 70.7%; font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1004.38em, 2.502em, -999.998em); top: -2.93em; left: 0em;"><span class="mo" id="MathJax-Span-1605" style=""><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 3.897em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 1.733em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.724em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.06em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.397em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.55em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.887em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.224em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.56em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.416em, 1000.34em, 4.281em, -999.998em); top: -5.334em; left: 2.022em;"><span class="mi" id="MathJax-Span-1606" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 2.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><msub><mi>s</mi><mn>0</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>1</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>2</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>3</mn></msub></mrow><mo>⏞</mo></mover></mrow><mi>p</mi></mover><mtext>&nbsp;</mtext><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><msub><mi>s</mi><mn>4</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>5</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>6</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>7</mn></msub></mrow><mo>⏞</mo></mover></mrow><mi>p</mi></mover></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-196">\overbrace{s_0 ~ s_1 ~ s_2 ~ s_3}^p ~ \overbrace{s_4 ~ s_5 ~ s_6 ~ s_7}^p</script>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-197-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/mover&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1607" style="width: 11.781em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.041em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(0.291em, 1009.04em, 4.233em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1608"><span class="msubsup" id="MathJax-Span-1609"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1610" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1611" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1612" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1613"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1614" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1615" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1616" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1617"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1618" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1619" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1620" style="font-family: MathJax_Main;">&nbsp;</span><span class="munderover" id="MathJax-Span-1621"><span style="display: inline-block; position: relative; width: 5.531em; height: 0px;"><span style="position: absolute; clip: rect(2.07em, 1005.53em, 5.05em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-1622"><span class="mrow" id="MathJax-Span-1623"><span class="munderover" id="MathJax-Span-1624"><span style="display: inline-block; position: relative; width: 5.531em; height: 0px;"><span style="position: absolute; clip: rect(2.07em, 1005.53em, 4.281em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1625"><span class="munderover" id="MathJax-Span-1626"><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; clip: rect(2.743em, 1004.38em, 4.281em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-1627"><span class="mrow" id="MathJax-Span-1628"><span class="munderover" id="MathJax-Span-1629"><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1004.33em, 4.281em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1630"><span class="msubsup" id="MathJax-Span-1631"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1632" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1633" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1634" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1635"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1636" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1637" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1638" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1639"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1640" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1641" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1642" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1643"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1644" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1645" style="font-size: 70.7%; font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1004.38em, 2.502em, -999.998em); top: -2.93em; left: 0em;"><span class="mo" id="MathJax-Span-1646" style=""><span style="display: inline-block; position: relative; width: 4.377em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 3.897em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 1.733em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.724em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.06em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.397em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.55em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.887em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.224em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.56em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.416em, 1000.34em, 4.281em, -999.998em); top: -5.334em; left: 2.022em;"><span class="mi" id="MathJax-Span-1647" style="font-size: 70.7%; font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1648" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1649"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1650" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1651" style="font-size: 70.7%; font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1005.53em, 2.502em, -999.998em); top: -1.488em; left: 0em;"><span class="mo" id="MathJax-Span-1652" style=""><span style="display: inline-block; position: relative; width: 5.531em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 5.05em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 2.31em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.435em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.82em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.204em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.541em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.925em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.175em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.56em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.945em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.329em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.666em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.32em, 1002.02em, 4.425em, -999.998em); top: -2.401em; left: 1.733em;"><span class="texatom" id="MathJax-Span-1653"><span class="mrow" id="MathJax-Span-1654"><span class="mi" id="MathJax-Span-1655" style="font-size: 70.7%; font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1656" style="font-size: 70.7%; font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-1657" style="font-size: 70.7%; font-family: MathJax_Main;">7</span><span class="mo" id="MathJax-Span-1658" style="font-size: 70.7%; font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1659" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1660" style="font-size: 70.7%; font-family: MathJax_Main;">5</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.497em; border-left: 0px solid; width: 0px; height: 4.878em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>s</mi><mn>0</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>1</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>2</mn></msub><mtext>&nbsp;</mtext><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><msub><mi>s</mi><mn>3</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>4</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>5</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>6</mn></msub></mrow><mo>⏞</mo></mover></mrow><mi>p</mi></mover><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>7</mn></msub></mrow><mo>⏟</mo></munder></mrow><mrow class="MJX-TeXAtom-ORD"><mi>π</mi><mo stretchy="false">[</mo><mn>7</mn><mo stretchy="false">]</mo><mo>=</mo><mn>5</mn></mrow></munder></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-197">s_0 ~ s_1 ~ s_2 ~ \underbrace{\overbrace{s_3 ~ s_4 ~ s_5 ~ s_6}^p ~ s_7}_{\pi[7] = 5}</script>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-198-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x21D2;&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1661" style="width: 32.022em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.618em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.541em, 1024.62em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1662"><span class="msubsup" id="MathJax-Span-1663"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1664" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1665" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-1666" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="msubsup" id="MathJax-Span-1667" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1668" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1669" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-1670" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1671" style="font-family: MathJax_Main; padding-left: 0.147em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1672"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1673" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1674" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-1675" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="msubsup" id="MathJax-Span-1676" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1677" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1678" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-1679" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1680" style="font-family: MathJax_Main; padding-left: 0.147em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1681"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1682" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1683" style="font-size: 70.7%; font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-1684" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="msubsup" id="MathJax-Span-1685" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1686" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1687" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-1688" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-1689" style="font-family: MathJax_Main; padding-left: 0.147em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1690"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1691" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1692" style="font-size: 70.7%; font-family: MathJax_Main;">7</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-1693" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="msubsup" id="MathJax-Span-1694" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1695" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1696" style="font-size: 70.7%; font-family: MathJax_Main;">6</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1697" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-1698" style="font-family: MathJax_Main; padding-left: 0.291em;">⇒</span><span class="mtext" id="MathJax-Span-1699" style="font-family: MathJax_Main; padding-left: 0.291em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1700"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1701" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1702" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-1703" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="msubsup" id="MathJax-Span-1704" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1705" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1706" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-1707" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="msubsup" id="MathJax-Span-1708" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1709" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1710" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-1711" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="msubsup" id="MathJax-Span-1712" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1713" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1714" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>s</mi><mn>4</mn></msub><mo>=</mo><msub><mi>s</mi><mn>3</mn></msub><mo>,</mo><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>5</mn></msub><mo>=</mo><msub><mi>s</mi><mn>4</mn></msub><mo>,</mo><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>6</mn></msub><mo>=</mo><msub><mi>s</mi><mn>5</mn></msub><mo>,</mo><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>7</mn></msub><mo>=</mo><msub><mi>s</mi><mn>6</mn></msub><mtext>&nbsp;</mtext><mo stretchy="false">⇒</mo><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><msub><mi>s</mi><mn>2</mn></msub><mo>=</mo><msub><mi>s</mi><mn>3</mn></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-198">s_4 = s_3, ~ s_5 = s_4, ~ s_6 = s_5, ~ s_7 = s_6 ~ \Rightarrow ~ s_0 = s_1 = s_2 = s_3</script></p>

<h3 id="toc-tgt-12">Building an automaton according to the prefix function</h3>

<p>Let's return to the concatenation to the two strings through a separator, i.e. for the strings <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-199-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1715" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1716"><span class="mi" id="MathJax-Span-1717" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-199">s</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-200-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1718" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1719"><span class="mi" id="MathJax-Span-1720" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-200">t</script> we compute the prefix function for the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-201-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1721" style="width: 5.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.185em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1004.14em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1722"><span class="mi" id="MathJax-Span-1723" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1724" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1725" style="font-family: MathJax_Main; padding-left: 0.243em;">#</span><span class="mo" id="MathJax-Span-1726" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1727" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">t</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>+</mo><mi mathvariant="normal">#</mi><mo>+</mo><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-201">s + \# + t</script>.
Obviously, since <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-202-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1728" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.77em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1729"><span class="mi" id="MathJax-Span-1730" style="font-family: MathJax_Main;">#</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">#</mi></math></span></span><script type="math/tex" id="MathJax-Element-202">\#</script> is a separator, the value of the prefix function will never exceed <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-203-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1731" style="width: 1.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.012em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1000.92em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1732"><span class="texatom" id="MathJax-Span-1733"><span class="mrow" id="MathJax-Span-1734"><span class="mo" id="MathJax-Span-1735" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1736" style="font-family: MathJax_Math-italic;">s</span><span class="texatom" id="MathJax-Span-1737"><span class="mrow" id="MathJax-Span-1738"><span class="mo" id="MathJax-Span-1739" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-203">|s|</script>.
If follows, that it is sufficient to only store the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-204-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1740" style="width: 3.32em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.55em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.5em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1741"><span class="mi" id="MathJax-Span-1742" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1743" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1744" style="font-family: MathJax_Main; padding-left: 0.243em;">#</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>+</mo><mi mathvariant="normal">#</mi></math></span></span><script type="math/tex" id="MathJax-Element-204">s + \#</script> and the values of the prefix function for it, and we can compute the prefix function for all subsequent character on the fly:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-205-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;need to store&lt;/mtext&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;munder&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;munder&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;do not need to store&lt;/mtext&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1745" style="width: 17.214em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.224em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1013.22em, 4.041em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1746"><span class="munderover" id="MathJax-Span-1747"><span style="display: inline-block; position: relative; width: 6.974em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1006.97em, 5.05em, -999.998em); top: -3.988em; left: 0em;"><span class="texatom" id="MathJax-Span-1748"><span class="mrow" id="MathJax-Span-1749"><span class="munderover" id="MathJax-Span-1750"><span style="display: inline-block; position: relative; width: 6.974em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1006.92em, 4.329em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1751"><span class="msubsup" id="MathJax-Span-1752"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1753" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1754" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1755" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1756"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1757" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1758" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1759" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-1760" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mtext" id="MathJax-Span-1761" style="font-family: MathJax_Main; padding-left: 0.147em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1762"><span style="display: inline-block; position: relative; width: 1.877em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1763" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-1764"><span class="mrow" id="MathJax-Span-1765"><span class="mi" id="MathJax-Span-1766" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1767" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1768" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1769" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-1770" style="font-family: MathJax_Main;">#</span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1006.97em, 2.502em, -999.998em); top: -1.44em; left: 0em;"><span class="mo" id="MathJax-Span-1771" style=""><span style="display: inline-block; position: relative; width: 6.974em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 6.541em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 3.031em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.435em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.82em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.156em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.541em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.925em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.31em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.695em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.897em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.281em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.666em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 5.772em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 6.156em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1003.9em, 4.233em, -999.998em); top: -2.401em; left: 1.541em;"><span class="texatom" id="MathJax-Span-1772"><span class="mrow" id="MathJax-Span-1773"><span class="mtext" id="MathJax-Span-1774" style="font-size: 70.7%; font-family: MathJax_Main;">need to store</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1775" style="font-family: MathJax_Main;">&nbsp;</span><span class="munderover" id="MathJax-Span-1776"><span style="display: inline-block; position: relative; width: 6.012em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1005.77em, 5.05em, -999.998em); top: -3.988em; left: 0.099em;"><span class="texatom" id="MathJax-Span-1777"><span class="mrow" id="MathJax-Span-1778"><span class="munderover" id="MathJax-Span-1779"><span style="display: inline-block; position: relative; width: 5.772em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1005.77em, 4.329em, -999.998em); top: -3.988em; left: 0.002em;"><span class="mrow" id="MathJax-Span-1780"><span class="msubsup" id="MathJax-Span-1781"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1782" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.387em;"><span class="mn" id="MathJax-Span-1783" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1784" style="font-family: MathJax_Main;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1785"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1786" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.387em;"><span class="mn" id="MathJax-Span-1787" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mtext" id="MathJax-Span-1788" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-1789" style="font-family: MathJax_Main; padding-left: 0.147em;">…</span><span class="mtext" id="MathJax-Span-1790" style="font-family: MathJax_Main; padding-left: 0.147em;">&nbsp;</span><span class="msubsup" id="MathJax-Span-1791"><span style="display: inline-block; position: relative; width: 1.974em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1792" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.387em;"><span class="texatom" id="MathJax-Span-1793"><span class="mrow" id="MathJax-Span-1794"><span class="mi" id="MathJax-Span-1795" style="font-size: 70.7%; font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-1796" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1797" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(1.685em, 1005.77em, 2.502em, -999.998em); top: -1.44em; left: 0em;"><span class="mo" id="MathJax-Span-1798" style=""><span style="display: inline-block; position: relative; width: 5.772em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 0.002em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 5.291em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.988em; left: 2.454em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.387em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 0.724em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.06em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.397em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 1.781em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 2.118em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.272em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.608em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 3.945em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.281em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.618em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.988em; left: 4.954em;"><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1006.01em, 4.233em, -999.998em); top: -2.401em; left: 0em;"><span class="texatom" id="MathJax-Span-1799"><span class="mrow" id="MathJax-Span-1800"><span class="mtext" id="MathJax-Span-1801" style="font-size: 70.7%; font-family: MathJax_Main;">do not need to store</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.247em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><msub><mi>s</mi><mn>0</mn></msub><mtext>&nbsp;</mtext><msub><mi>s</mi><mn>1</mn></msub><mtext>&nbsp;</mtext><mo>…</mo><mtext>&nbsp;</mtext><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mtext>&nbsp;</mtext><mi mathvariant="normal">#</mi></mrow><mo>⏟</mo></munder></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>need to store</mtext></mrow></munder><mtext>&nbsp;</mtext><munder><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><munder><mrow><msub><mi>t</mi><mn>0</mn></msub><mtext>&nbsp;</mtext><msub><mi>t</mi><mn>1</mn></msub><mtext>&nbsp;</mtext><mo>…</mo><mtext>&nbsp;</mtext><msub><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>m</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><mo>⏟</mo></munder></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>do not need to store</mtext></mrow></munder></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-205">\underbrace{s_0 ~ s_1 ~ \dots ~ s_{n-1} ~ \#}_{\text{need to store}} ~ \underbrace{t_0 ~ t_1 ~ \dots ~ t_{m-1}}_{\text{do not need to store}}</script></p>

<p>Indeed, in such a situation, knowing the next character <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-206-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1802" style="width: 2.695em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.07em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.445em, 1002.02em, 2.406em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1803"><span class="mi" id="MathJax-Span-1804" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-1805" style="font-family: MathJax_Main; padding-left: 0.291em;">∈</span><span class="mi" id="MathJax-Span-1806" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">t</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mo>∈</mo><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-206">c \in t</script> and the value of the prefix function of the previous position is enough information to compute the next value of the prefix function, without using any previous characters of the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-207-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1807" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1808"><span class="mi" id="MathJax-Span-1809" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-207">t</script> and the value of the prefix function in them.</p>

<p>In other words, we can construct an <strong>automaton</strong> (a finite state machine): the state in it is the current value of the prefix function, and the transition from one state to another will be performed via the next character.</p>

<p>Thus, even without having the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-208-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1810" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1811"><span class="mi" id="MathJax-Span-1812" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-208">t</script>, we can construct such a transition table <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-209-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mtext&gt;old&lt;/mtext&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mtext&gt;new&lt;/mtext&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1813" style="width: 10.964em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.416em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1008.42em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1814"><span class="mo" id="MathJax-Span-1815" style="font-family: MathJax_Main;">(</span><span class="mtext" id="MathJax-Span-1816" style="font-family: MathJax_Main;">old</span><span class="mi" id="MathJax-Span-1817" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-1818" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1819" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1820" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">c</span><span class="mo" id="MathJax-Span-1821" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1822" style="font-family: MathJax_Main; padding-left: 0.291em;">→</span><span class="mtext" id="MathJax-Span-1823" style="font-family: MathJax_Main; padding-left: 0.291em;">new</span><span class="mi" id="MathJax-Span-1824" style="font-family: MathJax_Main;">_</span><span class="mi" id="MathJax-Span-1825" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mtext>old</mtext><mi mathvariant="normal">_</mi><mi>π</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">→</mo><mtext>new</mtext><mi mathvariant="normal">_</mi><mi>π</mi></math></span></span><script type="math/tex" id="MathJax-Element-209">(\text{old}\_\pi, c) \rightarrow \text{new}\_\pi</script> using the same algorithm as for calculating the transition table:</p>

<pre><code class="cpp hljs"><span class="hljs-keyword">void</span> compute_automaton(<span class="hljs-built_in">string</span> s, <span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span>&gt;</span>&amp; aut) {
    s += <span class="hljs-string">'#'</span>;
    <span class="hljs-keyword">int</span> n = s.size();
    <span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span> pi = prefix_function(s);
    aut.assign(n, <span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span>(<span class="hljs-number">26</span>));
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> c = <span class="hljs-number">0</span>; c &lt; <span class="hljs-number">26</span>; c++) {
            <span class="hljs-keyword">int</span> j = i;
            <span class="hljs-keyword">while</span> (j &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-string">'a'</span> + c != s[j])
                j = pi[j-<span class="hljs-number">1</span>];
            <span class="hljs-keyword">if</span> (<span class="hljs-string">'a'</span> + c == s[j])
                j++;
            aut[i][c] = j;
        }
    }
}
</code></pre>

<p>However in this form the algorithm runs in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-210-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mn&gt;26&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1826" style="width: 4.666em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.56em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.252em, 1003.46em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1827"><span class="mi" id="MathJax-Span-1828" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1829" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1830"><span style="display: inline-block; position: relative; width: 1.012em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.58em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1831" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.579em;"><span class="mn" id="MathJax-Span-1832" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mn" id="MathJax-Span-1833" style="font-family: MathJax_Main;">26</span><span class="mo" id="MathJax-Span-1834" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mn>26</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-210">O(n^2 26)</script> time for the lowercase letters of the alphabet.
Note that we can apply dynamic programming and use the already calculated parts of the table.
Whenever we go from the value <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-211-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1835" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.43em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1836"><span class="mi" id="MathJax-Span-1837" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-211">j</script> to the value <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-212-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1838" style="width: 4.329em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.32em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.22em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1839"><span class="mi" id="MathJax-Span-1840" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1841" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1842" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1843" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-1844" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-1845" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>π</mi><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-212">\pi[j-1]</script>, we actually mean that the transition <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-213-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1846" style="width: 2.695em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.07em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1001.97em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1847"><span class="mo" id="MathJax-Span-1848" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1849" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1850" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1851" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">c</span><span class="mo" id="MathJax-Span-1852" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>j</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-213">(j, c)</script> leads to the same state as the transition as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-214-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1853" style="width: 6.445em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.954em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1004.86em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1854"><span class="mo" id="MathJax-Span-1855" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1856" style="font-family: MathJax_Math-italic;">π<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-1857" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1858" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-1859" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-1860" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-1861" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-1862" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1863" style="font-family: MathJax_Math-italic; padding-left: 0.147em;">c</span><span class="mo" id="MathJax-Span-1864" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>π</mi><mo stretchy="false">[</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-214">(\pi[j-1], c)</script>, and this answer is already accurately computed.</p>

<pre><code class="cpp hljs"><span class="hljs-keyword">void</span> compute_automaton(<span class="hljs-built_in">string</span> s, <span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span>&gt;</span>&amp; aut) {
    s += <span class="hljs-string">'#'</span>;
    <span class="hljs-keyword">int</span> n = s.size();
    <span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span> pi = prefix_function(s);
    aut.assign(n, <span class="hljs-stl_container"><span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;</span>(<span class="hljs-number">26</span>));
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> c = <span class="hljs-number">0</span>; c &lt; <span class="hljs-number">26</span>; c++) {
            <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-string">'a'</span> + c != s[i])
                aut[i][c] = aut[pi[i-<span class="hljs-number">1</span>]][c];
            <span class="hljs-keyword">else</span>
                aut[i][c] = i + (<span class="hljs-string">'a'</span> + c == s[i]);
        }
    }
}
</code></pre>

<p>As a result we construct the automaton in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-215-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;26&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1865" style="width: 4.089em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.127em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1003.03em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1866"><span class="mi" id="MathJax-Span-1867" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1868" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1869" style="font-family: MathJax_Math-italic;">n</span><span class="mn" id="MathJax-Span-1870" style="font-family: MathJax_Main;">26</span><span class="mo" id="MathJax-Span-1871" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mn>26</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-215">O(n 26)</script> time.</p>

<p>When is such a automaton useful?
To begin with, remember that we use the prefix function for the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-216-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1872" style="width: 5.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.185em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1004.14em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1873"><span class="mi" id="MathJax-Span-1874" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1875" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1876" style="font-family: MathJax_Main; padding-left: 0.243em;">#</span><span class="mo" id="MathJax-Span-1877" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1878" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">t</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>+</mo><mi mathvariant="normal">#</mi><mo>+</mo><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-216">s + \# + t</script> and its values mostly for a single purpose: find all occurrences of the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-217-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1879" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1880"><span class="mi" id="MathJax-Span-1881" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-217">s</script> in the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-218-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1882" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1883"><span class="mi" id="MathJax-Span-1884" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-218">t</script>.</p>

<p>Therefore the most obvious benefit of this automaton is the <strong>acceleration of calculating the prefix function</strong> for the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-219-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1885" style="width: 5.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.185em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1004.14em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1886"><span class="mi" id="MathJax-Span-1887" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1888" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1889" style="font-family: MathJax_Main; padding-left: 0.243em;">#</span><span class="mo" id="MathJax-Span-1890" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1891" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">t</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>+</mo><mi mathvariant="normal">#</mi><mo>+</mo><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-219">s + \# + t</script>.
By building the automaton for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-220-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0023;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1892" style="width: 3.32em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.55em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1002.5em, 2.55em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1893"><span class="mi" id="MathJax-Span-1894" style="font-family: MathJax_Math-italic;">s</span><span class="mo" id="MathJax-Span-1895" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-1896" style="font-family: MathJax_Main; padding-left: 0.243em;">#</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mo>+</mo><mi mathvariant="normal">#</mi></math></span></span><script type="math/tex" id="MathJax-Element-220">s + \#</script>, we no longer need to store the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-221-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1897" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1898"><span class="mi" id="MathJax-Span-1899" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-221">s</script> or the values of the prefix function in it.
All transitions are already computed in the table.</p>

<p>But there is a second, less obvious, application.
We can use the automaton when the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-222-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1900" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1901"><span class="mi" id="MathJax-Span-1902" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-222">t</script> is a <strong>gigantic string constructed using some rules</strong>.
This can for instance be the Gray strings, or a string formed by a recursive combination of several short strings from the input.</p>

<p>For completeness we will solve such a problem:
given a number <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-223-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1903" style="width: 4.329em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.32em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.204em, 1003.32em, 2.502em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1904"><span class="mi" id="MathJax-Span-1905" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-1906" style="font-family: MathJax_Main; padding-left: 0.291em;">≤</span><span class="msubsup" id="MathJax-Span-1907" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 1.445em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.96em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mn" id="MathJax-Span-1908" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -4.373em; left: 1.012em;"><span class="mn" id="MathJax-Span-1909" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>≤</mo><msup><mn>10</mn><mn>5</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-223">k \le 10^5</script> and a string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-224-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1910" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1911"><span class="mi" id="MathJax-Span-1912" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-224">s</script> of length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-225-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1913" style="width: 3.272em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.502em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.204em, 1002.5em, 2.502em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-1914"><span class="mo" id="MathJax-Span-1915" style="font-family: MathJax_Main;">≤</span><span class="msubsup" id="MathJax-Span-1916" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 1.445em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.96em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mn" id="MathJax-Span-1917" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -4.373em; left: 1.012em;"><span class="mn" id="MathJax-Span-1918" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≤</mo><msup><mn>10</mn><mn>5</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-225">\le 10^5</script>.
We have to compute the number of occurrences of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-226-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1919" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1920"><span class="mi" id="MathJax-Span-1921" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-226">s</script> in the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-227-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1922" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1923"><span class="mi" id="MathJax-Span-1924" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-227">k</script>-th Gray string.
Recall that Gray's strings are define in the following way:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-228-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1925" style="width: 14.57em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.204em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-0.671em, 1010.92em, 4.522em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1926"><span class="mtable" id="MathJax-Span-1927" style="padding-right: 0.147em; padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 10.916em; height: 0px;"><span style="position: absolute; clip: rect(3.079em, 1000.92em, 7.935em, -999.998em); top: -5.575em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.92em, 4.329em, -999.998em); top: -5.911em; right: 0em;"><span class="mtd" id="MathJax-Span-1928"><span class="mrow" id="MathJax-Span-1929"><span class="msubsup" id="MathJax-Span-1930"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.48em, 4.329em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1931" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1932" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.416em, 1000.92em, 4.329em, -999.998em); top: -4.613em; right: 0em;"><span class="mtd" id="MathJax-Span-1939"><span class="mrow" id="MathJax-Span-1940"><span class="msubsup" id="MathJax-Span-1941"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.48em, 4.329em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1942" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1943" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.416em, 1000.92em, 4.329em, -999.998em); top: -3.267em; right: 0em;"><span class="mtd" id="MathJax-Span-1952"><span class="mrow" id="MathJax-Span-1953"><span class="msubsup" id="MathJax-Span-1954"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.48em, 4.329em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1955" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1956" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.416em, 1000.92em, 4.329em, -999.998em); top: -1.969em; right: 0em;"><span class="mtd" id="MathJax-Span-1969"><span class="mrow" id="MathJax-Span-1970"><span class="msubsup" id="MathJax-Span-1971"><span style="display: inline-block; position: relative; width: 0.916em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.48em, 4.329em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-1972" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mn" id="MathJax-Span-1973" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.579em;"></span></span><span style="position: absolute; clip: rect(2.887em, 1009.86em, 7.791em, -999.998em); top: -5.623em; left: 0.916em;"><span style="display: inline-block; position: relative; width: 10.002em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1003.03em, 4.137em, -999.998em); top: -5.911em; left: 0em;"><span class="mtd" id="MathJax-Span-1933"><span class="mrow" id="MathJax-Span-1934"><span class="mi" id="MathJax-Span-1935"></span><span class="mo" id="MathJax-Span-1936" style="font-family: MathJax_Main; padding-left: 0.291em;">=<span style="font-family: MathJax_Main;">"</span></span><span class="mi" id="MathJax-Span-1937" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">a</span><span class="mo" id="MathJax-Span-1938" style="font-family: MathJax_Main; padding-left: 0.291em;">"</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.175em, 1003.99em, 4.137em, -999.998em); top: -4.613em; left: 0em;"><span class="mtd" id="MathJax-Span-1944"><span class="mrow" id="MathJax-Span-1945"><span class="mi" id="MathJax-Span-1946"></span><span class="mo" id="MathJax-Span-1947" style="font-family: MathJax_Main; padding-left: 0.291em;">=<span style="font-family: MathJax_Main;">"</span></span><span class="mi" id="MathJax-Span-1948" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">a</span><span class="mi" id="MathJax-Span-1949" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-1950" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1951" style="font-family: MathJax_Main; padding-left: 0.291em;">"</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.175em, 1005.92em, 4.137em, -999.998em); top: -3.267em; left: 0em;"><span class="mtd" id="MathJax-Span-1957"><span class="mrow" id="MathJax-Span-1958"><span class="mi" id="MathJax-Span-1959"></span><span class="mo" id="MathJax-Span-1960" style="font-family: MathJax_Main; padding-left: 0.291em;">=<span style="font-family: MathJax_Main;">"</span></span><span class="mi" id="MathJax-Span-1961" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">a</span><span class="mi" id="MathJax-Span-1962" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-1963" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1964" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1965" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1966" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-1967" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1968" style="font-family: MathJax_Main; padding-left: 0.291em;">"</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.175em, 1009.86em, 4.137em, -999.998em); top: -1.969em; left: 0em;"><span class="mtd" id="MathJax-Span-1974"><span class="mrow" id="MathJax-Span-1975"><span class="mi" id="MathJax-Span-1976"></span><span class="mo" id="MathJax-Span-1977" style="font-family: MathJax_Main; padding-left: 0.291em;">=<span style="font-family: MathJax_Main;">"</span></span><span class="mi" id="MathJax-Span-1978" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">a</span><span class="mi" id="MathJax-Span-1979" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-1980" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1981" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1982" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1983" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-1984" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1985" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-1986" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1987" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-1988" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1989" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-1990" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1991" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-1992" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1993" style="font-family: MathJax_Main; padding-left: 0.291em;">"</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.627em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.934em; border-left: 0px solid; width: 0px; height: 6.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>g</mi><mn>1</mn></msub></mtd><mtd><mi></mi><mo>="</mo><mi>a</mi><mo>"</mo></mtd></mtr><mtr><mtd><msub><mi>g</mi><mn>2</mn></msub></mtd><mtd><mi></mi><mo>="</mo><mi>a</mi><mi>b</mi><mi>a</mi><mo>"</mo></mtd></mtr><mtr><mtd><msub><mi>g</mi><mn>3</mn></msub></mtd><mtd><mi></mi><mo>="</mo><mi>a</mi><mi>b</mi><mi>a</mi><mi>c</mi><mi>a</mi><mi>b</mi><mi>a</mi><mo>"</mo></mtd></mtr><mtr><mtd><msub><mi>g</mi><mn>4</mn></msub></mtd><mtd><mi></mi><mo>="</mo><mi>a</mi><mi>b</mi><mi>a</mi><mi>c</mi><mi>a</mi><mi>b</mi><mi>a</mi><mi>d</mi><mi>a</mi><mi>b</mi><mi>a</mi><mi>c</mi><mi>a</mi><mi>b</mi><mi>a</mi><mo>"</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-228">\begin{align}
g_1 &= "a"\\
g_2 &= "aba"\\
g_3 &= "abacaba"\\
g_4 &= "abacabadabacaba"
\end{align}</script></p>

<p>In such cases even constructing the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-229-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1994" style="width: 0.531em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.387em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.34em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1995"><span class="mi" id="MathJax-Span-1996" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-229">t</script> will be impossible, because of its astronomical length.
The <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-230-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1997" style="width: 0.724em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.531em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.53em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-1998"><span class="mi" id="MathJax-Span-1999" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-230">k</script>-th Gray string is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-231-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2000" style="width: 3.56em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.743em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.204em, 1002.65em, 2.454em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-2001"><span class="msubsup" id="MathJax-Span-2002"><span style="display: inline-block; position: relative; width: 0.964em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1000.43em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mn" id="MathJax-Span-2003" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -4.373em; left: 0.483em;"><span class="mi" id="MathJax-Span-2004" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-2005" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-2006" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>k</mi></msup><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-231">2^k-1</script> characters long.
However we can calculate the value of the prefix function at the end of the string effectively, by only knowing the value of the prefix function at the start.</p>

<p>In addition to the automaton itself, we also compute values <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-232-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2007" style="width: 3.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.647em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1002.55em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-2008"><span class="mi" id="MathJax-Span-2009" style="font-family: MathJax_Math-italic;">G</span><span class="mo" id="MathJax-Span-2010" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2011" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2012" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2013" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2014" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2015" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-232">G[i][j]</script> - the value of the automaton after processing the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-233-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2016" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.82em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2017"><span class="msubsup" id="MathJax-Span-2018"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.48em, 4.329em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2019" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mi" id="MathJax-Span-2020" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-233">g_i</script> starting with the state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-234-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2021" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.43em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2022"><span class="mi" id="MathJax-Span-2023" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-234">j</script>.
And additionally we compute values <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-235-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2024" style="width: 3.656em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.791em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1002.7em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-2025"><span class="mi" id="MathJax-Span-2026" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mo" id="MathJax-Span-2027" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2028" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2029" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2030" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2031" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2032" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-235">K[i][j]</script> - the number of occurrences of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-236-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2033" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2034"><span class="mi" id="MathJax-Span-2035" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-236">s</script> in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-237-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2036" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.82em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2037"><span class="msubsup" id="MathJax-Span-2038"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.48em, 4.329em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2039" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mi" id="MathJax-Span-2040" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-237">g_i</script>, before during the processing of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-238-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2041" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.82em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2042"><span class="msubsup" id="MathJax-Span-2043"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.48em, 4.329em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2044" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mi" id="MathJax-Span-2045" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-238">g_i</script> starting with the state <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-239-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2046" style="width: 0.579em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.435em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.43em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2047"><span class="mi" id="MathJax-Span-2048" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-239">j</script>.
Actually <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-240-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2049" style="width: 3.656em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.791em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1002.7em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-2050"><span class="mi" id="MathJax-Span-2051" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mo" id="MathJax-Span-2052" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2053" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2054" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2055" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2056" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2057" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-240">K[i][j]</script> is the number of times that the prefix function took the value <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-241-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2058" style="width: 1.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.012em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1000.92em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-2059"><span class="texatom" id="MathJax-Span-2060"><span class="mrow" id="MathJax-Span-2061"><span class="mo" id="MathJax-Span-2062" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2063" style="font-family: MathJax_Math-italic;">s</span><span class="texatom" id="MathJax-Span-2064"><span class="mrow" id="MathJax-Span-2065"><span class="mo" id="MathJax-Span-2066" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-241">|s|</script> while performing the operations.
The answer to the problem will then be <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-242-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2067" style="width: 3.945em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.031em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1002.93em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-2068"><span class="mi" id="MathJax-Span-2069" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mo" id="MathJax-Span-2070" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2071" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-2072" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2073" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-2074" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2075" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi><mo stretchy="false">[</mo><mi>k</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-242">K[k][0]</script>.</p>

<p>How can we compute these values?
First the basic values are <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-243-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2076" style="width: 5.964em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.57em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1004.57em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-2077"><span class="mi" id="MathJax-Span-2078" style="font-family: MathJax_Math-italic;">G</span><span class="mo" id="MathJax-Span-2079" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-2080" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2081" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2082" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2083" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2084" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2085" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-2086" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">j</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-243">G[0][j] = j</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-244-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2087" style="width: 6.252em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.81em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1004.76em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-2088"><span class="mi" id="MathJax-Span-2089" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mo" id="MathJax-Span-2090" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-2091" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-2092" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2093" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2094" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2095" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2096" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mn" id="MathJax-Span-2097" style="font-family: MathJax_Main; padding-left: 0.291em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-244">K[0][j] = 0</script>.
And all subsequent values can be calculated from the previous values and using the automaton.
To calculate the value for some <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-245-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2098" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2099"><span class="mi" id="MathJax-Span-2100" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-245">i</script> we remember that the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-246-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2101" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.82em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2102"><span class="msubsup" id="MathJax-Span-2103"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.48em, 4.329em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2104" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="mi" id="MathJax-Span-2105" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-246">g_i</script> consists of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-247-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2106" style="width: 2.214em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1001.68em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2107"><span class="msubsup" id="MathJax-Span-2108"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.48em, 4.329em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2109" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-2110"><span class="mrow" id="MathJax-Span-2111"><span class="mi" id="MathJax-Span-2112" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2113" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2114" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-247">g_{i-1}</script>, the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-248-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2115" style="width: 0.435em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.349em, 1000.29em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2116"><span class="mi" id="MathJax-Span-2117" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-248">i</script> character of the alphabet, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-249-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2118" style="width: 2.214em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1001.68em, 2.502em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2119"><span class="msubsup" id="MathJax-Span-2120"><span style="display: inline-block; position: relative; width: 1.685em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.48em, 4.329em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2121" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.483em;"><span class="texatom" id="MathJax-Span-2122"><span class="mrow" id="MathJax-Span-2123"><span class="mi" id="MathJax-Span-2124" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2125" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-2126" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-249">g_{i-1}</script>.
Thus the automaton will go into the state:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-250-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;mid&lt;/mtext&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;aut&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2127" style="width: 13.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.339em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1010.24em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-2128"><span class="mtext" id="MathJax-Span-2129" style="font-family: MathJax_Main;">mid</span><span class="mo" id="MathJax-Span-2130" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mtext" id="MathJax-Span-2131" style="font-family: MathJax_Main; padding-left: 0.291em;">aut</span><span class="mo" id="MathJax-Span-2132" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2133" style="font-family: MathJax_Math-italic;">G</span><span class="mo" id="MathJax-Span-2134" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2135" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2136" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-2137" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-2138" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2139" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2140" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2141" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2142" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2143" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2144" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2145" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>mid</mtext><mo>=</mo><mtext>aut</mtext><mo stretchy="false">[</mo><mi>G</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-250">\text{mid} = \text{aut}[G[i-1][j]][i]</script>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-251-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;G&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mtext&gt;mid&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2146" style="width: 12.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.714em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1009.62em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-2147"><span class="mi" id="MathJax-Span-2148" style="font-family: MathJax_Math-italic;">G</span><span class="mo" id="MathJax-Span-2149" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2150" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2151" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2152" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2153" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2154" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2155" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-2156" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">G</span><span class="mo" id="MathJax-Span-2157" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2158" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2159" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-2160" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-2161" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2162" style="font-family: MathJax_Main;">[</span><span class="mtext" id="MathJax-Span-2163" style="font-family: MathJax_Main;">mid</span><span class="mo" id="MathJax-Span-2164" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>G</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>G</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mtext>mid</mtext><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-251">G[i][j] = G[i-1][\text{mid}]</script>
The values for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-252-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2165" style="width: 3.656em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.791em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1002.7em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-2166"><span class="mi" id="MathJax-Span-2167" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mo" id="MathJax-Span-2168" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2169" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2170" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2171" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2172" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2173" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-252">K[i][j]</script> can also be easily counted.
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-253-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mtext&gt;mid&lt;/mtext&gt;&lt;mo&gt;==&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mtext&gt;mid&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2174" style="width: 29.377em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.599em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.3em, 1022.5em, 2.599em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-2175"><span class="mi" id="MathJax-Span-2176" style="font-family: MathJax_Math-italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mo" id="MathJax-Span-2177" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2178" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2179" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2180" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2181" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2182" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2183" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="mi" id="MathJax-Span-2184" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mo" id="MathJax-Span-2185" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2186" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2187" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-2188" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-2189" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2190" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2191" style="font-family: MathJax_Math-italic;">j</span><span class="mo" id="MathJax-Span-2192" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2193" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mo" id="MathJax-Span-2194" style="font-family: MathJax_Main; padding-left: 0.243em;">(</span><span class="mtext" id="MathJax-Span-2195" style="font-family: MathJax_Main;">mid</span><span class="mo" id="MathJax-Span-2196" style="font-family: MathJax_Main; padding-left: 0.291em;">=<span style="font-family: MathJax_Main;">=</span></span><span class="texatom" id="MathJax-Span-2197" style="padding-left: 0.291em;"><span class="mrow" id="MathJax-Span-2198"><span class="mo" id="MathJax-Span-2199" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-2200" style="font-family: MathJax_Math-italic;">s</span><span class="texatom" id="MathJax-Span-2201"><span class="mrow" id="MathJax-Span-2202"><span class="mo" id="MathJax-Span-2203" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-2204" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2205" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="mi" id="MathJax-Span-2206" style="font-family: MathJax_Math-italic; padding-left: 0.243em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.05em;"></span></span><span class="mo" id="MathJax-Span-2207" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-2208" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-2209" style="font-family: MathJax_Main; padding-left: 0.243em;">−</span><span class="mn" id="MathJax-Span-2210" style="font-family: MathJax_Main; padding-left: 0.243em;">1</span><span class="mo" id="MathJax-Span-2211" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-2212" style="font-family: MathJax_Main;">[</span><span class="mtext" id="MathJax-Span-2213" style="font-family: MathJax_Main;">mid</span><span class="mo" id="MathJax-Span-2214" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>K</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>=</mo><mi>K</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>j</mi><mo stretchy="false">]</mo><mo>+</mo><mo stretchy="false">(</mo><mtext>mid</mtext><mo>==</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">)</mo><mo>+</mo><mi>K</mi><mo stretchy="false">[</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mtext>mid</mtext><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-253">K[i][j] = K[i-1][j] + (\text{mid} == |s|) + K[i-1][\text{mid}]</script></p>

<p>So we can solve the problem for Gray strings, and similarly also a huge number of other similar problems.
For example the exact same method also solves the following problem:
we are given a string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-254-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2215" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2216"><span class="mi" id="MathJax-Span-2217" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-254">s</script> and some patterns <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-255-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2218" style="width: 0.916em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.675em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.67em, 2.454em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2219"><span class="msubsup" id="MathJax-Span-2220"><span style="display: inline-block; position: relative; width: 0.675em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2221" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.387em;"><span class="mi" id="MathJax-Span-2222" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-255">t_i</script>, each of which is specified as follows:
it is a string of ordinary characters, and there might be some recursive insertions of the previous strings of the form <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-256-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;cnt&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2223" style="width: 1.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.397em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.252em, 1001.4em, 2.647em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2224"><span class="msubsup" id="MathJax-Span-2225"><span style="display: inline-block; position: relative; width: 1.397em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2226" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.416em, 1001.06em, 4.137em, -999.998em); top: -4.325em; left: 0.387em;"><span class="texatom" id="MathJax-Span-2227"><span class="mrow" id="MathJax-Span-2228"><span class="mtext" id="MathJax-Span-2229" style="font-size: 70.7%; font-family: MathJax_Main;">cnt</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.137em, -999.998em); top: -3.651em; left: 0.387em;"><span class="mi" id="MathJax-Span-2230" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>t</mi><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mtext>cnt</mtext></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-256">t_k^{\text{cnt}}</script>, which means that at this place we have to insert the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-257-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2231" style="width: 1.06em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.397em, 1000.82em, 2.454em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2232"><span class="msubsup" id="MathJax-Span-2233"><span style="display: inline-block; position: relative; width: 0.82em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2234" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.387em;"><span class="mi" id="MathJax-Span-2235" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-257">t_k</script> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-258-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;cnt&lt;/mtext&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2236" style="width: 1.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.397em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.445em, 1001.35em, 2.358em, -999.998em); top: -2.209em; left: 0em;"><span class="mrow" id="MathJax-Span-2237"><span class="mtext" id="MathJax-Span-2238" style="font-family: MathJax_Main;">cnt</span></span><span style="display: inline-block; width: 0px; height: 2.214em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>cnt</mtext></math></span></span><script type="math/tex" id="MathJax-Element-258">\text{cnt}</script> times.
An example of such patterns:
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-259-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;30&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;&amp;quot;&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;50&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2239" style="width: 14.906em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.445em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(-0.911em, 1011.16em, 4.714em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2240"><span class="mtable" id="MathJax-Span-2241" style="padding-right: 0.147em; padding-left: 0.147em;"><span style="display: inline-block; position: relative; width: 11.156em; height: 0px;"><span style="position: absolute; clip: rect(3.079em, 1000.77em, 8.368em, -999.998em); top: -5.959em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.77em, 4.281em, -999.998em); top: -6.103em; right: 0em;"><span class="mtd" id="MathJax-Span-2242"><span class="mrow" id="MathJax-Span-2243"><span class="msubsup" id="MathJax-Span-2244"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2245" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.387em;"><span class="mn" id="MathJax-Span-2246" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.224em, 1000.77em, 4.281em, -999.998em); top: -4.757em; right: 0em;"><span class="mtd" id="MathJax-Span-2258"><span class="mrow" id="MathJax-Span-2259"><span class="msubsup" id="MathJax-Span-2260"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2261" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.387em;"><span class="mn" id="MathJax-Span-2262" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.224em, 1000.77em, 4.281em, -999.998em); top: -3.315em; right: 0em;"><span class="mtd" id="MathJax-Span-2284"><span class="mrow" id="MathJax-Span-2285"><span class="msubsup" id="MathJax-Span-2286"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2287" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.387em;"><span class="mn" id="MathJax-Span-2288" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.224em, 1000.77em, 4.281em, -999.998em); top: -1.873em; right: 0em;"><span class="mtd" id="MathJax-Span-2306"><span class="mrow" id="MathJax-Span-2307"><span class="msubsup" id="MathJax-Span-2308"><span style="display: inline-block; position: relative; width: 0.772em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2309" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -3.844em; left: 0.387em;"><span class="mn" id="MathJax-Span-2310" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.964em;"></span></span><span style="position: absolute; clip: rect(3.272em, 1010.24em, 8.752em, -999.998em); top: -6.2em; left: 0.772em;"><span style="display: inline-block; position: relative; width: 10.387em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1005.43em, 4.137em, -999.998em); top: -6.103em; left: 0em;"><span class="mtd" id="MathJax-Span-2247"><span class="mrow" id="MathJax-Span-2248"><span class="mi" id="MathJax-Span-2249"></span><span class="mo" id="MathJax-Span-2250" style="font-family: MathJax_Main; padding-left: 0.291em;">=<span style="font-family: MathJax_Main;">"</span></span><span class="mi" id="MathJax-Span-2251" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">a</span><span class="mi" id="MathJax-Span-2252" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-2253" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mi" id="MathJax-Span-2254" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-2255" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-2256" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-2257" style="font-family: MathJax_Main; padding-left: 0.291em;">"</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.031em, 1010.24em, 4.425em, -999.998em); top: -4.757em; left: 0em;"><span class="mtd" id="MathJax-Span-2263"><span class="mrow" id="MathJax-Span-2264"><span class="mi" id="MathJax-Span-2265"></span><span class="mo" id="MathJax-Span-2266" style="font-family: MathJax_Main; padding-left: 0.291em;">=<span style="font-family: MathJax_Main;">"</span></span><span class="mi" id="MathJax-Span-2267" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">a</span><span class="mi" id="MathJax-Span-2268" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-2269" style="font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-2270" style="font-family: MathJax_Main; padding-left: 0.291em;">"</span><span class="mo" id="MathJax-Span-2271" style="font-family: MathJax_Main; padding-left: 0.291em;">+</span><span class="msubsup" id="MathJax-Span-2272"><span style="display: inline-block; position: relative; width: 1.156em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2273" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.77em, 4.137em, -999.998em); top: -4.325em; left: 0.387em;"><span class="texatom" id="MathJax-Span-2274"><span class="mrow" id="MathJax-Span-2275"><span class="mn" id="MathJax-Span-2276" style="font-size: 70.7%; font-family: MathJax_Main;">30</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.137em, -999.998em); top: -3.7em; left: 0.387em;"><span class="mn" id="MathJax-Span-2277" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-2278" style="font-family: MathJax_Main;">+</span><span class="mo" id="MathJax-Span-2279" style="font-family: MathJax_Main; padding-left: 0.291em;">"</span><span class="mi" id="MathJax-Span-2280" style="font-family: MathJax_Math-italic; padding-left: 0.291em;">a</span><span class="mi" id="MathJax-Span-2281" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-2282" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-2283" style="font-family: MathJax_Main; padding-left: 0.291em;">"</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.031em, 1005.24em, 4.425em, -999.998em); top: -3.315em; left: 0em;"><span class="mtd" id="MathJax-Span-2289"><span class="mrow" id="MathJax-Span-2290"><span class="mi" id="MathJax-Span-2291"></span><span class="mo" id="MathJax-Span-2292" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="msubsup" id="MathJax-Span-2293" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 1.156em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2294" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.77em, 4.137em, -999.998em); top: -4.325em; left: 0.387em;"><span class="texatom" id="MathJax-Span-2295"><span class="mrow" id="MathJax-Span-2296"><span class="mn" id="MathJax-Span-2297" style="font-size: 70.7%; font-family: MathJax_Main;">50</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.137em, -999.998em); top: -3.7em; left: 0.387em;"><span class="mn" id="MathJax-Span-2298" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-2299" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="msubsup" id="MathJax-Span-2300" style="padding-left: 0.243em;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2301" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1001.16em, 4.137em, -999.998em); top: -4.325em; left: 0.387em;"><span class="texatom" id="MathJax-Span-2302"><span class="mrow" id="MathJax-Span-2303"><span class="mn" id="MathJax-Span-2304" style="font-size: 70.7%; font-family: MathJax_Main;">100</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.137em, -999.998em); top: -3.7em; left: 0.387em;"><span class="mn" id="MathJax-Span-2305" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.031em, 1005.24em, 4.474em, -999.998em); top: -1.873em; left: 0em;"><span class="mtd" id="MathJax-Span-2311"><span class="mrow" id="MathJax-Span-2312"><span class="mi" id="MathJax-Span-2313"></span><span class="mo" id="MathJax-Span-2314" style="font-family: MathJax_Main; padding-left: 0.291em;">=</span><span class="msubsup" id="MathJax-Span-2315" style="padding-left: 0.291em;"><span style="display: inline-block; position: relative; width: 1.156em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2316" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.77em, 4.137em, -999.998em); top: -4.325em; left: 0.387em;"><span class="texatom" id="MathJax-Span-2317"><span class="mrow" id="MathJax-Span-2318"><span class="mn" id="MathJax-Span-2319" style="font-size: 70.7%; font-family: MathJax_Main;">10</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.137em, -999.998em); top: -3.7em; left: 0.387em;"><span class="mn" id="MathJax-Span-2320" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span><span class="mo" id="MathJax-Span-2321" style="font-family: MathJax_Main; padding-left: 0.243em;">+</span><span class="msubsup" id="MathJax-Span-2322" style="padding-left: 0.243em;"><span style="display: inline-block; position: relative; width: 1.493em; height: 0px;"><span style="position: absolute; clip: rect(3.224em, 1000.34em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mi" id="MathJax-Span-2323" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1001.16em, 4.137em, -999.998em); top: -4.325em; left: 0.387em;"><span class="texatom" id="MathJax-Span-2324"><span class="mrow" id="MathJax-Span-2325"><span class="mn" id="MathJax-Span-2326" style="font-size: 70.7%; font-family: MathJax_Main;">100</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; clip: rect(3.368em, 1000.43em, 4.137em, -999.998em); top: -3.7em; left: 0.387em;"><span class="mn" id="MathJax-Span-2327" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.204em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -3.184em; border-left: 0px solid; width: 0px; height: 7.066em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><msub><mi>t</mi><mn>1</mn></msub></mtd><mtd><mi></mi><mo>="</mo><mi>a</mi><mi>b</mi><mi>d</mi><mi>e</mi><mi>c</mi><mi>a</mi><mo>"</mo></mtd></mtr><mtr><mtd><msub><mi>t</mi><mn>2</mn></msub></mtd><mtd><mi></mi><mo>="</mo><mi>a</mi><mi>b</mi><mi>c</mi><mo>"</mo><mo>+</mo><msubsup><mi>t</mi><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mn>30</mn></mrow></msubsup><mo>+</mo><mo>"</mo><mi>a</mi><mi>b</mi><mi>d</mi><mo>"</mo></mtd></mtr><mtr><mtd><msub><mi>t</mi><mn>3</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msubsup><mi>t</mi><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>50</mn></mrow></msubsup><mo>+</mo><msubsup><mi>t</mi><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mn>100</mn></mrow></msubsup></mtd></mtr><mtr><mtd><msub><mi>t</mi><mn>4</mn></msub></mtd><mtd><mi></mi><mo>=</mo><msubsup><mi>t</mi><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow></msubsup><mo>+</mo><msubsup><mi>t</mi><mn>3</mn><mrow class="MJX-TeXAtom-ORD"><mn>100</mn></mrow></msubsup></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-259">\begin{align}
t_1 &= "abdeca"\\
t_2 &= "abc" + t_1^{30} + "abd"\\
t_3 &= t_2^{50} + t_1^{100}\\
t_4 &= t_2^{10} + t_3^{100}
\end{align}</script></p>

<p>The recursive substitutions blow the string up, so that their lengths can reach the order of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-260-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2328" style="width: 3.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.647em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.156em, 1002.65em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2329"><span class="msubsup" id="MathJax-Span-2330"><span style="display: inline-block; position: relative; width: 2.647em; height: 0px;"><span style="position: absolute; clip: rect(3.175em, 1001.45em, 4.137em, -999.998em); top: -3.988em; left: 0em;"><span class="mn" id="MathJax-Span-2331" style="font-family: MathJax_Main;">100</span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span><span style="position: absolute; top: -4.373em; left: 1.493em;"><span class="texatom" id="MathJax-Span-2332"><span class="mrow" id="MathJax-Span-2333"><span class="mn" id="MathJax-Span-2334" style="font-size: 70.7%; font-family: MathJax_Main;">100</span></span></span><span style="display: inline-block; width: 0px; height: 3.993em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>100</mn><mrow class="MJX-TeXAtom-ORD"><mn>100</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-260">100^{100}</script>.</p>

<p>We have to find the number of times the string <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-261-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2335" style="width: 0.627em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.483em; height: 0px; font-size: 130%;"><span style="position: absolute; clip: rect(1.589em, 1000.43em, 2.31em, -999.998em); top: -2.161em; left: 0em;"><span class="mrow" id="MathJax-Span-2336"><span class="mi" id="MathJax-Span-2337" style="font-family: MathJax_Math-italic;">s</span></span><span style="display: inline-block; width: 0px; height: 2.166em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-261">s</script> appears in each of the strings.</p>

<p>The problem can be solved in the same way by constructing the automaton of the prefix function, and then we calculate the transitions in for each pattern by using the previous results.</p>

<h2 id="toc-tgt-13">Practice Problems</h2>

<ul>
<li><a href="http://uva.onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=396">UVA # 455 "Periodic Strings"</a></li>
<li><a href="http://uva.onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=1963">UVA # 11022 "String Factoring"</a></li>
<li><a href="http://uva.onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=2447">UVA # 11452 "Dancing the Cheeky-Cheeky"</a></li>
<li><a href="https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=4282">UVA 12604 - Caesar Cipher</a></li>
<li><a href="https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=3911">UVA 12467 - Secret Word</a></li>
<li><a href="https://uva.onlinejudge.org/index.php?option=onlinejudge&amp;page=show_problem&amp;problem=1960">UVA 11019 - Matrix Matcher</a></li>
<li><a href="http://www.spoj.com/problems/NAJPF/">SPOJ - Pattern Find</a></li>
<li><a href="http://codeforces.com/contest/808/problem/G">Codeforces - Anthem of Berland</a></li>
<li><a href="http://codeforces.com/problemset/problem/471/D">Codeforces - MUH and Cube Walls</a></li>
</ul>

    <div id="footer">
    (c) 2014-2019 translation by <a href="http://github.com/e-maxx-eng">http://github.com/e-maxx-eng</a>
    <span style="float: right; cursor: pointer;">24:5888/2477</span></div>
</div>

<script>
if (/e\-maxx\-eng|cp\-algorithms/.test(location.href)) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-85220282-1', 'auto');
  ga('send', 'pageview');
}
</script>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size4, sans-serif;"></div></div></body></html>